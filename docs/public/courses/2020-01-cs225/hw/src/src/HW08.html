<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HW08</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Testing.html"><span class="hs-identifier">Util.Testing</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Lex.html"><span class="hs-identifier">Util.Lex</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L7.html"><span class="hs-identifier">Lang.L7</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L7</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- ========= --</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- UTILITIES --</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- ========= --</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-identifier">freshInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-52"></a><a name="freshInteger"><a href="HW08.html#freshInteger"><span class="hs-identifier">freshInteger</span></a></a><span> </span><a name="local-6989586621679115984"><a href="#local-6989586621679115984"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679115984"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-54"></a><span>  </span><a name="local-6989586621679115985"><a href="#local-6989586621679115985"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679115986"><a href="#local-6989586621679115986"><span class="hs-identifier">is'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679115987"><a href="#local-6989586621679115987"><span class="hs-identifier">i'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HW08.html#freshInteger"><span class="hs-identifier hs-var">freshInteger</span></a><span> </span><a href="#local-6989586621679115986"><span class="hs-identifier hs-var">is'</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679115985"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679115987"><span class="hs-identifier hs-var">i'</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">freshLocation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L7.Data.html#Store"><span class="hs-identifier hs-type">L7.Store</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-59"></a><a name="freshLocation"><a href="HW08.html#freshLocation"><span class="hs-identifier">freshLocation</span></a></a><span> </span><a name="local-6989586621679115988"><a href="#local-6989586621679115988"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HW08.html#freshInteger"><span class="hs-identifier hs-var">freshInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.keys</span><span> </span><a href="#local-6989586621679115988"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">{-

Here is an example program in our new object-oriented language:
let Point = 
      class
      fields x y
      method get-x =&gt; !self.x
      method get-y =&gt; !self.y
      method set-x =&gt; fun x =&gt; self.x &lt;- x
      method set-y =&gt; fun y =&gt; self.y &lt;- y
      method norm-sq =&gt; self.get-x * self.get-x + self.get-y * self.get-y
      method double =&gt; 
        self.set-x (self.get-x * 2) ;
        self.set-y (self.get-y * 2)
      end
in
let p = new Point { x = 1, y = 2 } in 
let x = p.norm-sq in
p.set-x 3 ;
p.set-y 4 ;
p.double ;
x + p.norm-sq

Notice the new language constructs:
- `class` for creating a new class
- `new` for creating a new object
- `e.name` for accessing the field or method of an object

New terms:

e &#8712; expr &#10868; &#8230;
         | class fields x &#8230; x [method x =&gt; e] &#8230; [method x =&gt; e] end
         | new e { x = e , &#8230; , x = e }
         | e.x

Class expressions will evaluate to class values, which close over the
environment just like lambdas, and new object expressions evalute to object
values, which also keep a copy of the closure environment created at class
creation time.

v &#8712; value &#10868; &#8230;
          | &#10216;class fields x &#8230; x [method x =&gt; e] &#8230; [method x =&gt; e] end, &#947;&#10217;
          | &#10216;object fields {x &#8614; &#8467; , &#8230; , x &#8614; &#8467;} methods {x &#8614; e , &#8230; , x &#8614; e}, &#947;&#10217;
  
-}</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- [E1]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-117"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- When we create new objects with object creation syntax:</span><span>
</span><a name="line-120"></a><span class="hs-comment">--</span><span>
</span><a name="line-121"></a><span class="hs-comment">--     new Point { x = 1, y = 2 }</span><span>
</span><a name="line-122"></a><span class="hs-comment">--</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- We need to check that the keys in the syntax `x` and `y` correspond with the</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- same names from the class definition's syntax:</span><span>
</span><a name="line-125"></a><span class="hs-comment">--</span><span>
</span><a name="line-126"></a><span class="hs-comment">--     class </span><span>
</span><a name="line-127"></a><span class="hs-comment">--     fields x y</span><span>
</span><a name="line-128"></a><span class="hs-comment">--     &#8230;</span><span>
</span><a name="line-129"></a><span class="hs-comment">--</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- At this point in the interpreter, `fields x y` is represented as a list of</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- strings:</span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-comment">--     [&quot;x&quot;,&quot;y&quot;]</span><span>
</span><a name="line-134"></a><span class="hs-comment">--</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- and the object creation syntax is represented as:</span><span>
</span><a name="line-136"></a><span class="hs-comment">--</span><span>
</span><a name="line-137"></a><span class="hs-comment">--     [(&quot;x&quot;, IntE 1), (&quot;y&quot;, IntE 2)]</span><span>
</span><a name="line-138"></a><span class="hs-comment">--</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- We need a function that checks that the first list is the same as the first</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- elements of the second list, up to permutation. Here is the formal spec:</span><span>
</span><a name="line-141"></a><span class="hs-comment">--</span><span>
</span><a name="line-142"></a><span class="hs-comment">--     checkFields &#8712; list(var) &#8743; list(var &#215; expr) &#8594; &#120121;</span><span>
</span><a name="line-143"></a><span class="hs-comment">--     checkFields((x&#8321;,&#8230;,x&#8345;),[(y&#8321;,e&#8321;),&#8230;,(y&#8345;,e&#8345;)]) &#8796; {x&#8321;,&#8230;,x&#8345;} = {y&#8321;,&#8230;,y&#8345;}</span><span>
</span><a name="line-144"></a><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- Notice that `{x&#8321;,&#8230;,x&#8345;}` and `{y&#8321;,&#8230;,y&#8345;}` must be equal *as sets*; it isn't</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- enough to be the same list, because they must be the same list up to any</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- permutation. For example, if we swapped the &quot;x&quot; and the &quot;y&quot;, then</span><span>
</span><a name="line-148"></a><span class="hs-comment">-- it should still return the same result, that is, </span><span>
</span><a name="line-149"></a><span class="hs-comment">--</span><span>
</span><a name="line-150"></a><span class="hs-comment">--   checkFields [&quot;y&quot;, &quot;x&quot;] [(&quot;x&quot;, IntE 1), (&quot;y&quot;, IntE 2)]</span><span>
</span><a name="line-151"></a><span class="hs-comment">--</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- should return True.</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- - convert each list to a Haskell Set datatype and use Haskell's equality operator (==).</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- - to convert a list to a set, use Set.fromList.</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- - to turn a list of pairs into a list of the first element of each pair, use `map fst`.</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-identifier">checkFields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><a href="Lang.L7.Data.html#Expr"><span class="hs-identifier hs-type">L7.Expr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-160"></a><a name="checkFields"><a href="HW08.html#checkFields"><span class="hs-identifier">checkFields</span></a></a><span> </span><a name="local-6989586621679115989"><a href="#local-6989586621679115989"><span class="hs-identifier">fields</span></a></a><span> </span><a name="local-6989586621679115990"><a href="#local-6989586621679115990"><span class="hs-identifier">fieldls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-identifier">testE1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-163"></a><a name="testE1"><a href="HW08.html#testE1"><span class="hs-identifier">testE1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;checkFields&quot;</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="HW08.html#checkFields"><span class="hs-identifier hs-var">checkFields</span></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw08/e1&quot;</span><span>
</span><a name="line-168"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pList"><span class="hs-identifier hs-var">pList</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pList"><span class="hs-identifier hs-var">pList</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pTup"><span class="hs-identifier hs-var">pTup</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span> </span><a href="Lang.L7.Util.html#pExpr"><span class="hs-identifier hs-var">L7.pExpr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Util.Lex.html#pBool"><span class="hs-identifier hs-var">pBool</span></a><span>
</span><a name="line-169"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- [E2]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-173"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- To interpret object creation syntax, such as: </span><span>
</span><a name="line-176"></a><span class="hs-comment">--</span><span>
</span><a name="line-177"></a><span class="hs-comment">--     new Point { x = 1 + 1, y = 2 + 2 }</span><span>
</span><a name="line-178"></a><span class="hs-comment">--</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- we need to:</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- - evaluate each of the field initialization expressions, `1 + 1` and `2 + 2`</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- - allocate new locations in the store to hold these results, because object</span><span>
</span><a name="line-182"></a><span class="hs-comment">--   fields are mutable</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- - return a map from field names to locations, where each location is</span><span>
</span><a name="line-184"></a><span class="hs-comment">--   initalized to the value returned by evaluating the initialization</span><span>
</span><a name="line-185"></a><span class="hs-comment">--   expression</span><span>
</span><a name="line-186"></a><span class="hs-comment">--</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- For example, in the `Point` example shown above, this should:</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- - evalute `1 + 1` and `2 + 2` to the values `2` and `4`</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- - allocate new locations `loc 1` and `loc 2` in the store for each result</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- - map each location to a field value in the store, so `loc 1 &#8614; 2` and `loc 2 &#8614; 4`</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- - return a map from field names to the locations that hold their values, so</span><span>
</span><a name="line-192"></a><span class="hs-comment">--   `x &#8614; loc 1` and `y &#8614; loc 2`</span><span>
</span><a name="line-193"></a><span class="hs-comment">--</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- The spec for the function is as follows:</span><span>
</span><a name="line-195"></a><span class="hs-comment">--</span><span>
</span><a name="line-196"></a><span class="hs-comment">--     interp-fields &#8712; list(var &#215; expr) &#215; env &#215; store &#8594; maybe((var &#8640; location) &#215; store)</span><span>
</span><a name="line-197"></a><span class="hs-comment">--     interp-fields([(x&#8321;,e&#8321;),&#8230;,(x&#8345;,e&#8345;)],&#947;,&#963;&#8320;) &#8796; ({x&#8321; &#8614; &#8467;&#8321;,&#8230;,x&#8345; &#8614; &#8467;&#8345;}, &#963;&#8242;)</span><span>
</span><a name="line-198"></a><span class="hs-comment">--       where</span><span>
</span><a name="line-199"></a><span class="hs-comment">--         (v&#8321;,&#963;&#8321;) = &#10214;e&#8321;&#10215;(&#947;,&#963;&#8320;)</span><span>
</span><a name="line-200"></a><span class="hs-comment">--                 &#8942;</span><span>
</span><a name="line-201"></a><span class="hs-comment">--         (v&#8345;,&#963;&#8345;) = &#10214;e&#8345;&#10215;(&#947;,&#963;&#8345;&#8331;&#8321;)</span><span>
</span><a name="line-202"></a><span class="hs-comment">--         {&#8467;&#8321;,&#8230;,&#8467;&#8345;} &#8745; dom(&#963;&#8345;) = &#8709;</span><span>
</span><a name="line-203"></a><span class="hs-comment">--         &#8467;&#7522; &#8800; &#8467;&#11388; for i &#8800; j</span><span>
</span><a name="line-204"></a><span class="hs-comment">--         &#963;&#8242; = &#963;&#8345;[&#8467;&#8321;&#8614;v&#8321;,&#8230;,&#8467;&#8345;&#8614;v&#8345;]</span><span>
</span><a name="line-205"></a><span class="hs-comment">--</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- - Define this function by recursion on the list of fields</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- - This definition should call `interp`, and `interp` should call this</span><span>
</span><a name="line-209"></a><span class="hs-comment">--   definition (`interpFields`). These functions will be mutually recursive.</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- - Don't forget to &quot;thread&quot; the store, </span><span>
</span><a name="line-211"></a><span class="hs-comment">-- - Don't forget to handle all pattern match cases</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- - You'll want to use `freshLocation`, provided above in the utilities</span><span>
</span><a name="line-213"></a><span class="hs-comment">--   section.</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- - Although the specification doesn't say what order the locations are</span><span>
</span><a name="line-215"></a><span class="hs-comment">--   allocated in, the tests expect a specific ordering. Look at the expected</span><span>
</span><a name="line-216"></a><span class="hs-comment">--   input and output behavior from the tests in order to make sure your</span><span>
</span><a name="line-217"></a><span class="hs-comment">--   implementation is doing the right allocation order to pass the tests.</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- - You might find helpful these functions from the Map datatype api:</span><span>
</span><a name="line-219"></a><span class="hs-comment">--</span><span>
</span><a name="line-220"></a><span class="hs-comment">--       Map.empty :: Map k v</span><span>
</span><a name="line-221"></a><span class="hs-comment">--       Map.insert :: k -&gt; v -&gt; Map k v -&gt; Map k v</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">interpFields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Lang.L7.Data.html#Expr"><span class="hs-identifier hs-type">L7.Expr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L7.Data.html#Env"><span class="hs-identifier hs-type">L7.Env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L7.Data.html#Store"><span class="hs-identifier hs-type">L7.Store</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><a href="Lang.L7.Data.html#Store"><span class="hs-identifier hs-type">L7.Store</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><a name="interpFields"><a href="HW08.html#interpFields"><span class="hs-identifier">interpFields</span></a></a><span> </span><a name="local-6989586621679116021"><a href="#local-6989586621679116021"><span class="hs-identifier">fields</span></a></a><span> </span><a name="local-6989586621679116022"><a href="#local-6989586621679116022"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679116023"><a href="#local-6989586621679116023"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">testE2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-227"></a><a name="testE2"><a href="HW08.html#testE2"><span class="hs-identifier">testE2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-228"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpFields&quot;</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="HW08.html#interpFields"><span class="hs-identifier hs-var">interpFields</span></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw08/e2&quot;</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pList"><span class="hs-identifier hs-var">pList</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pTup"><span class="hs-identifier hs-var">pTup</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span> </span><a href="Lang.L7.Util.html#pExpr"><span class="hs-identifier hs-var">L7.pExpr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Lang.L7.Util.html#pEnv"><span class="hs-identifier hs-var">L7.pEnv</span></a><span class="hs-special">)</span><span> </span><a href="Lang.L7.Util.html#pStore"><span class="hs-identifier hs-var">L7.pStore</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-233"></a><span>      </span><a href="Util.Lex.html#pMaybe"><span class="hs-identifier hs-var">pMaybe</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pMap"><span class="hs-identifier hs-var">pMap</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span> </span><a href="Lang.L7.Util.html#pLoc"><span class="hs-identifier hs-var">L7.pLoc</span></a><span class="hs-special">)</span><span> </span><a href="Lang.L7.Util.html#pStore"><span class="hs-identifier hs-var">L7.pStore</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- [E3]: &#9733;&#9733;&#9733; --</span><span>
</span><a name="line-238"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- Write an interpreter for our new core language with first class classes and</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- objects. The interpreter has the same definition from HW07 for all of the</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- syntax that isn't new in this homework. The interpreter definition for new</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- terms is as follows:</span><span>
</span><a name="line-244"></a><span class="hs-comment">--</span><span>
</span><a name="line-245"></a><span class="hs-comment">--     &#10214;_&#10215; &#8712; expr &#8594; env &#215; store &#8594; maybe(value &#215; store)</span><span>
</span><a name="line-246"></a><span class="hs-comment">--     &#10214;class fields x&#8321; &#8230; x&#8345; [method x&#8242;&#8321; =&gt; e&#8321;] &#8230; [method x&#8242;&#8344; =&gt; e&#8344;] end&#10215;(&#947;,&#963;) &#8796; (v,&#963;)</span><span>
</span><a name="line-247"></a><span class="hs-comment">--       where</span><span>
</span><a name="line-248"></a><span class="hs-comment">--       v = &#10216;class fields x&#8321; &#8230; x&#8345; [method x&#8242;&#8321; =&gt; e&#8321;] &#8230; [method x&#8242;&#8344; =&gt; e&#8344;] end, &#947;&#10217;</span><span>
</span><a name="line-249"></a><span class="hs-comment">--     &#10214;new e { x&#8321; = e&#8321; , &#8230; , x&#8345; = e&#8345; }&#10215;(&#947;,&#963;) &#8796; (v&#8242;,&#963;&#8242;)</span><span>
</span><a name="line-250"></a><span class="hs-comment">--       where</span><span>
</span><a name="line-251"></a><span class="hs-comment">--         (v, &#963;&#8320;) = &#10214;e&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-252"></a><span class="hs-comment">--         v = &#10216;class fields y&#8321; &#8230; y&#8345; [method y&#8242;&#8321; =&gt; e&#8242;&#8321;] &#8230; [method y&#8242;&#8344; =&gt; e&#8242;&#8344;] end, &#947;&#8242;&#10217;</span><span>
</span><a name="line-253"></a><span class="hs-comment">--         {x&#8321;,&#8230;,x&#8345;} = {y&#8321;,&#8230;,y&#8345;}</span><span>
</span><a name="line-254"></a><span class="hs-comment">--         (v&#8321;,&#963;&#8321;) = &#10214;e&#8321;&#10215;(&#947;,&#963;&#8320;)</span><span>
</span><a name="line-255"></a><span class="hs-comment">--                 &#8942;</span><span>
</span><a name="line-256"></a><span class="hs-comment">--         (v&#8345;,&#963;&#8345;) = &#10214;e&#8345;&#10215;(&#947;,&#963;&#8345;&#8331;&#8321;)</span><span>
</span><a name="line-257"></a><span class="hs-comment">--         {&#8467;&#8321;,&#8230;,&#8467;&#8345;} &#8745; dom(&#963;&#8345;) = &#8709;</span><span>
</span><a name="line-258"></a><span class="hs-comment">--         &#8467;&#7522; &#8800; &#8467;&#11388; for i &#8800; j</span><span>
</span><a name="line-259"></a><span class="hs-comment">--         v&#8242; = &#10216;object fields {x&#8321; &#8614; &#8467;&#8321; , &#8230; , x&#8345; &#8614; &#8467;&#8345;} methods {y&#8242;&#8321; &#8614; e&#8242;&#8321; , &#8230; , y&#8242;&#8344; &#8614; e&#8242;&#8344; }, &#947;&#8242;&#10217;</span><span>
</span><a name="line-260"></a><span class="hs-comment">--         &#963;&#8242; = &#963;&#8345;[&#8467;&#8321;&#8614;v&#8321;,&#8230;,&#8467;&#8345;&#8614;v&#8345;]</span><span>
</span><a name="line-261"></a><span class="hs-comment">--    &#10214;e.x&#10215;(&#947;,&#963;) &#8796; (loc &#8467;&#7522;,&#963;&#8242;)</span><span>
</span><a name="line-262"></a><span class="hs-comment">--      where</span><span>
</span><a name="line-263"></a><span class="hs-comment">--        (v, &#963;&#8242;) = &#10214;e&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-264"></a><span class="hs-comment">--        v = &#10216;object fields {x&#8321; &#8614; &#8467;&#8321; , &#8230; , x&#8345; &#8614; &#8467;&#8345;} methods {x&#8242;&#8321; &#8614; e&#8321; , &#8230; , x&#8242;&#8344; &#8614; e&#8344;}, &#947;&#8242;&#10217;</span><span>
</span><a name="line-265"></a><span class="hs-comment">--        x = x&#7522;</span><span>
</span><a name="line-266"></a><span class="hs-comment">--    &#10214;e.x&#10215;(&#947;,&#963;) &#8796; &#10214;e&#7522;&#10215;(&#947;&#8242;[self&#8614;v],&#963;&#8242;)</span><span>
</span><a name="line-267"></a><span class="hs-comment">--      where</span><span>
</span><a name="line-268"></a><span class="hs-comment">--        (v, &#963;&#8242;) = &#10214;e&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-269"></a><span class="hs-comment">--        v = &#10216;object fields {x&#8321; &#8614; &#8467;&#8321; , &#8230; , x&#8345; &#8614; &#8467;&#8345;} methods {x&#8242;&#8321; &#8614; e&#8321; , &#8230; , x&#8242;&#8344; &#8614; e&#8344;}, &#947;&#8242;&#10217;</span><span>
</span><a name="line-270"></a><span class="hs-comment">--        x &#8713; {x&#8321;,&#8230;,x&#8345;}</span><span>
</span><a name="line-271"></a><span class="hs-comment">--        x = x&#8242;&#7522;</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-identifier">interp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L7.Data.html#Expr"><span class="hs-identifier hs-type">L7.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L7.Data.html#Env"><span class="hs-identifier hs-type">L7.Env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L7.Data.html#Store"><span class="hs-identifier hs-type">L7.Store</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#Value"><span class="hs-identifier hs-type">L7.Value</span></a><span class="hs-special">,</span><span> </span><a href="Lang.L7.Data.html#Store"><span class="hs-identifier hs-type">L7.Store</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><a name="interp"><a href="HW08.html#interp"><span class="hs-identifier">interp</span></a></a><span> </span><a name="local-6989586621679116024"><a href="#local-6989586621679116024"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679116025"><a href="#local-6989586621679116025"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679116026"><a href="#local-6989586621679116026"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679116024"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-275"></a><span>  </span><a href="Lang.L7.Data.html#IntE"><span class="hs-identifier hs-var">L7.IntE</span></a><span> </span><a name="local-6989586621679116027"><a href="#local-6989586621679116027"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><a href="#local-6989586621679116027"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>  </span><a href="Lang.L7.Data.html#PlusE"><span class="hs-identifier hs-var">L7.PlusE</span></a><span> </span><a name="local-6989586621679116028"><a href="#local-6989586621679116028"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116029"><a href="#local-6989586621679116029"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116028"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-277"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><a name="local-6989586621679116030"><a href="#local-6989586621679116030"><span class="hs-identifier">i1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116031"><a href="#local-6989586621679116031"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116029"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116031"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-278"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><a name="local-6989586621679116032"><a href="#local-6989586621679116032"><span class="hs-identifier">i2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116033"><a href="#local-6989586621679116033"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679116030"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679116032"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116033"><span class="hs-identifier hs-var">sto''</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-281"></a><span>  </span><a href="Lang.L7.Data.html#TimesE"><span class="hs-identifier hs-var">L7.TimesE</span></a><span> </span><a name="local-6989586621679116034"><a href="#local-6989586621679116034"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116035"><a href="#local-6989586621679116035"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116034"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><a name="local-6989586621679116036"><a href="#local-6989586621679116036"><span class="hs-identifier">i1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116037"><a href="#local-6989586621679116037"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116035"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116037"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-283"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><a name="local-6989586621679116038"><a href="#local-6989586621679116038"><span class="hs-identifier">i2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116039"><a href="#local-6989586621679116039"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#IntV"><span class="hs-identifier hs-var">L7.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679116036"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679116038"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116039"><span class="hs-identifier hs-var">sto''</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-285"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-286"></a><span>  </span><a href="Lang.L7.Data.html#BoolE"><span class="hs-identifier hs-var">L7.BoolE</span></a><span> </span><a name="local-6989586621679116040"><a href="#local-6989586621679116040"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#BoolV"><span class="hs-identifier hs-var">L7.BoolV</span></a><span> </span><a href="#local-6989586621679116040"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>  </span><a href="Lang.L7.Data.html#IfE"><span class="hs-identifier hs-var">L7.IfE</span></a><span> </span><a name="local-6989586621679116041"><a href="#local-6989586621679116041"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116042"><a href="#local-6989586621679116042"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679116043"><a href="#local-6989586621679116043"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116041"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#BoolV"><span class="hs-identifier hs-var">L7.BoolV</span></a><span> </span><a name="local-6989586621679116044"><a href="#local-6989586621679116044"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116045"><a href="#local-6989586621679116045"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-289"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679116044"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-290"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116042"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116045"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-291"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116043"><span class="hs-identifier hs-var">e3</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116045"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-292"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-293"></a><span>  </span><a href="Lang.L7.Data.html#VarE"><span class="hs-identifier hs-var">L7.VarE</span></a><span> </span><a name="local-6989586621679116046"><a href="#local-6989586621679116046"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679116046"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679116047"><a href="#local-6989586621679116047"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679116047"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-296"></a><span>  </span><a href="Lang.L7.Data.html#LetE"><span class="hs-identifier hs-var">L7.LetE</span></a><span> </span><a name="local-6989586621679116048"><a href="#local-6989586621679116048"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679116049"><a href="#local-6989586621679116049"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116050"><a href="#local-6989586621679116050"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116049"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679116051"><a href="#local-6989586621679116051"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116052"><a href="#local-6989586621679116052"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116050"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679116048"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679116051"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679116052"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-298"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-299"></a><span>  </span><a href="Lang.L7.Data.html#FunE"><span class="hs-identifier hs-var">L7.FunE</span></a><span> </span><a name="local-6989586621679116053"><a href="#local-6989586621679116053"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679116054"><a href="#local-6989586621679116054"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#CloV"><span class="hs-identifier hs-var">L7.CloV</span></a><span> </span><a href="#local-6989586621679116053"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679116054"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>  </span><a href="Lang.L7.Data.html#AppE"><span class="hs-identifier hs-var">L7.AppE</span></a><span> </span><a name="local-6989586621679116055"><a href="#local-6989586621679116055"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116056"><a href="#local-6989586621679116056"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116055"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-301"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#CloV"><span class="hs-identifier hs-var">L7.CloV</span></a><span> </span><a name="local-6989586621679116057"><a href="#local-6989586621679116057"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679116058"><a href="#local-6989586621679116058"><span class="hs-identifier">e'</span></a></a><span> </span><a name="local-6989586621679116059"><a href="#local-6989586621679116059"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116060"><a href="#local-6989586621679116060"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116056"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116060"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-302"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679116061"><a href="#local-6989586621679116061"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116062"><a href="#local-6989586621679116062"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116058"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679116057"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679116061"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679116059"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679116062"><span class="hs-identifier hs-var">sto''</span></a><span>
</span><a name="line-303"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-304"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-305"></a><span>  </span><a href="Lang.L7.Data.html#BoxE"><span class="hs-identifier hs-var">L7.BoxE</span></a><span> </span><a name="local-6989586621679116063"><a href="#local-6989586621679116063"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116063"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679116064"><a href="#local-6989586621679116064"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116065"><a href="#local-6989586621679116065"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-307"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679116066"><a href="#local-6989586621679116066"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HW08.html#freshLocation"><span class="hs-identifier hs-var">freshLocation</span></a><span> </span><a href="#local-6989586621679116065"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-308"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#LocV"><span class="hs-identifier hs-var">L7.LocV</span></a><span> </span><a href="#local-6989586621679116066"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679116066"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679116064"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679116065"><span class="hs-identifier hs-var">sto'</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-310"></a><span>  </span><a href="Lang.L7.Data.html#UnboxE"><span class="hs-identifier hs-var">L7.UnboxE</span></a><span> </span><a name="local-6989586621679116067"><a href="#local-6989586621679116067"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116067"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-311"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#LocV"><span class="hs-identifier hs-var">L7.LocV</span></a><span> </span><a name="local-6989586621679116068"><a href="#local-6989586621679116068"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116069"><a href="#local-6989586621679116069"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679116068"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679116069"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-312"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679116070"><a href="#local-6989586621679116070"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679116070"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679116069"><span class="hs-identifier hs-var">sto'</span></a><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-314"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-315"></a><span>  </span><a href="Lang.L7.Data.html#AssignE"><span class="hs-identifier hs-var">L7.AssignE</span></a><span> </span><a name="local-6989586621679116071"><a href="#local-6989586621679116071"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679116072"><a href="#local-6989586621679116072"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116071"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-316"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L7.Data.html#LocV"><span class="hs-identifier hs-var">L7.LocV</span></a><span> </span><a name="local-6989586621679116073"><a href="#local-6989586621679116073"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116074"><a href="#local-6989586621679116074"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116072"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679116074"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-317"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679116075"><a href="#local-6989586621679116075"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679116076"><a href="#local-6989586621679116076"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679116075"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679116073"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679116075"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679116076"><span class="hs-identifier hs-var">sto''</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-319"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-320"></a><span>  </span><a href="Lang.L7.Data.html#ClassE"><span class="hs-identifier hs-var">L7.ClassE</span></a><span> </span><a name="local-6989586621679116077"><a href="#local-6989586621679116077"><span class="hs-identifier">fields</span></a></a><span> </span><a name="local-6989586621679116078"><a href="#local-6989586621679116078"><span class="hs-identifier">methods</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-321"></a><span>  </span><a href="Lang.L7.Data.html#NewE"><span class="hs-identifier hs-var">L7.NewE</span></a><span> </span><a name="local-6989586621679116079"><a href="#local-6989586621679116079"><span class="hs-identifier">e'</span></a></a><span> </span><a name="local-6989586621679116080"><a href="#local-6989586621679116080"><span class="hs-identifier">fieldes</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-322"></a><span>  </span><a href="Lang.L7.Data.html#AccessE"><span class="hs-identifier hs-var">L7.AccessE</span></a><span> </span><a name="local-6989586621679116081"><a href="#local-6989586621679116081"><span class="hs-identifier">e'</span></a></a><span> </span><a name="local-6989586621679116082"><a href="#local-6989586621679116082"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">testE3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-325"></a><a name="testE3"><a href="HW08.html#testE3"><span class="hs-identifier">testE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-327"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interp&quot;</span><span>
</span><a name="line-328"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679116083"><a href="#local-6989586621679116083"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW08.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679116083"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679116084"><a href="#local-6989586621679116084"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679116084"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw08/e3&quot;</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L7.Util.html#pExpr"><span class="hs-identifier hs-var">L7.pExpr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Util.Lex.html#pMaybe"><span class="hs-identifier hs-var">pMaybe</span></a><span> </span><a href="Lang.L7.Util.html#pValue"><span class="hs-identifier hs-var">L7.pValue</span></a><span>
</span><a name="line-331"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><a name="main"><a href="HW08.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#runTests"><span class="hs-identifier hs-var">runTests</span></a><span>
</span><a name="line-335"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-336"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="HW08.html#testE1"><span class="hs-identifier hs-var">testE1</span></a><span>
</span><a name="line-337"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW08.html#testE2"><span class="hs-identifier hs-var">testE2</span></a><span>
</span><a name="line-338"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW08.html#testE3"><span class="hs-identifier hs-var">testE3</span></a><span>
</span><a name="line-339"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-340"></a></pre></body></html>