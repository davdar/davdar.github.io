<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HW06</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Testing.html"><span class="hs-identifier">Util.Testing</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Lex.html"><span class="hs-identifier">Util.Lex</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L5.html"><span class="hs-identifier">Lang.L5</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L5</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- REFERECE --</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- Here is a copy of the contents of Lang.L5.Data for your reference:</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- -----------------</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- -- EXPRESSIONS --</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- -----------------</span><span>
</span><a name="line-56"></a><span class="hs-comment">--</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- data Expr = </span><span>
</span><a name="line-58"></a><span class="hs-comment">--     IntE Integer</span><span>
</span><a name="line-59"></a><span class="hs-comment">--   | PlusE Expr Expr </span><span>
</span><a name="line-60"></a><span class="hs-comment">--   | TimesE Expr Expr</span><span>
</span><a name="line-61"></a><span class="hs-comment">--   | BoolE Bool</span><span>
</span><a name="line-62"></a><span class="hs-comment">--   | IfE Expr Expr Expr</span><span>
</span><a name="line-63"></a><span class="hs-comment">--   | VarE String</span><span>
</span><a name="line-64"></a><span class="hs-comment">--   | LetE String Expr Expr</span><span>
</span><a name="line-65"></a><span class="hs-comment">--   -- NEW</span><span>
</span><a name="line-66"></a><span class="hs-comment">--   | FunE String Expr</span><span>
</span><a name="line-67"></a><span class="hs-comment">--   | AppE Expr Expr</span><span>
</span><a name="line-68"></a><span class="hs-comment">--   deriving (Eq,Ord,Show)</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- </span><span>
</span><a name="line-70"></a><span class="hs-comment">-- ---------------------------</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- -- ENVIRONMENT SEMANTICS --</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- ---------------------------</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- </span><span>
</span><a name="line-74"></a><span class="hs-comment">-- data ValueE = </span><span>
</span><a name="line-75"></a><span class="hs-comment">--     IntEV Integer</span><span>
</span><a name="line-76"></a><span class="hs-comment">--   | BoolEV Bool</span><span>
</span><a name="line-77"></a><span class="hs-comment">--   -- NEW</span><span>
</span><a name="line-78"></a><span class="hs-comment">--   | CloEV String Expr EnvE</span><span>
</span><a name="line-79"></a><span class="hs-comment">--   deriving (Eq,Ord,Show)</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- </span><span>
</span><a name="line-81"></a><span class="hs-comment">-- data AnswerE = </span><span>
</span><a name="line-82"></a><span class="hs-comment">--     ValueEA ValueE</span><span>
</span><a name="line-83"></a><span class="hs-comment">--   | BadEA</span><span>
</span><a name="line-84"></a><span class="hs-comment">--   deriving (Eq,Ord,Show)</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- </span><span>
</span><a name="line-86"></a><span class="hs-comment">-- type EnvE = Map String ValueE</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- </span><span>
</span><a name="line-88"></a><span class="hs-comment">-- ----------------------------</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- -- SUBSTITUTION SEMANTICS --</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- ----------------------------</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- </span><span>
</span><a name="line-92"></a><span class="hs-comment">-- data ValueS =</span><span>
</span><a name="line-93"></a><span class="hs-comment">--     IntSV Integer</span><span>
</span><a name="line-94"></a><span class="hs-comment">--   | BoolSV Bool</span><span>
</span><a name="line-95"></a><span class="hs-comment">--   | FunSV String Expr</span><span>
</span><a name="line-96"></a><span class="hs-comment">--   deriving (Eq,Ord,Show)</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- </span><span>
</span><a name="line-98"></a><span class="hs-comment">-- data AnswerS =</span><span>
</span><a name="line-99"></a><span class="hs-comment">--     ValueSA ValueS</span><span>
</span><a name="line-100"></a><span class="hs-comment">--   | BadSA</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   deriving (Eq,Ord,Show)</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- </span><span>
</span><a name="line-103"></a><span class="hs-comment">-- type EnvS = Map String ValueS</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">----------</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- [X1] --</span><span>
</span><a name="line-111"></a><span class="hs-comment">----------</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- Convert a (substitution-based) value into an expression.</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">exprFromValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L5.Data.html#ValueS"><span class="hs-identifier hs-type">L5.ValueS</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span>
</span><a name="line-116"></a><a name="exprFromValue"><a href="HW06.html#exprFromValue"><span class="hs-identifier">exprFromValue</span></a></a><span> </span><a name="local-6989586621679105322"><a href="#local-6989586621679105322"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105322"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-117"></a><span>  </span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105323"><a href="#local-6989586621679105323"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a href="#local-6989586621679105323"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-118"></a><span>  </span><a href="Lang.L5.Data.html#BoolSV"><span class="hs-identifier hs-var">L5.BoolSV</span></a><span> </span><a name="local-6989586621679105324"><a href="#local-6989586621679105324"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a href="#local-6989586621679105324"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-119"></a><span>  </span><a href="Lang.L5.Data.html#FunSV"><span class="hs-identifier hs-var">L5.FunSV</span></a><span> </span><a name="local-6989586621679105325"><a href="#local-6989586621679105325"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105326"><a href="#local-6989586621679105326"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#FunE"><span class="hs-identifier hs-var">L5.FunE</span></a><span> </span><a href="#local-6989586621679105325"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105326"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">testX1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-123"></a><a name="testX1"><a href="HW06.html#testX1"><span class="hs-identifier">testX1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1&quot;</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;exprFromValue&quot;</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#exprFromValue"><span class="hs-identifier hs-var">exprFromValue</span></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/x1&quot;</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L5.Util.html#pValueS"><span class="hs-identifier hs-var">L5.pValueS</span></a><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">----------</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- [X2] -- </span><span>
</span><a name="line-133"></a><span class="hs-comment">----------</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- Compute the free variables of an expression.</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-identifier">freeVarsExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-138"></a><a name="freeVarsExpr"><a href="HW06.html#freeVarsExpr"><span class="hs-identifier">freeVarsExpr</span></a></a><span> </span><a name="local-6989586621679105327"><a href="#local-6989586621679105327"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105327"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-139"></a><span>  </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a name="local-6989586621679105328"><a href="#local-6989586621679105328"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-140"></a><span>  </span><a href="Lang.L5.Data.html#PlusE"><span class="hs-identifier hs-var">L5.PlusE</span></a><span> </span><a name="local-6989586621679105329"><a href="#local-6989586621679105329"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105330"><a href="#local-6989586621679105330"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105329"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105330"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>  </span><a href="Lang.L5.Data.html#TimesE"><span class="hs-identifier hs-var">L5.TimesE</span></a><span> </span><a name="local-6989586621679105331"><a href="#local-6989586621679105331"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105332"><a href="#local-6989586621679105332"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105331"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105332"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a name="local-6989586621679105333"><a href="#local-6989586621679105333"><span class="hs-identifier">_b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-143"></a><span>  </span><a href="Lang.L5.Data.html#IfE"><span class="hs-identifier hs-var">L5.IfE</span></a><span> </span><a name="local-6989586621679105334"><a href="#local-6989586621679105334"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105335"><a href="#local-6989586621679105335"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679105336"><a href="#local-6989586621679105336"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105334"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105335"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105336"><span class="hs-identifier hs-var">e3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>  </span><a href="Lang.L5.Data.html#VarE"><span class="hs-identifier hs-var">L5.VarE</span></a><span> </span><a name="local-6989586621679105337"><a href="#local-6989586621679105337"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679105337"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-145"></a><span>  </span><a href="Lang.L5.Data.html#LetE"><span class="hs-identifier hs-var">L5.LetE</span></a><span> </span><a name="local-6989586621679105338"><a href="#local-6989586621679105338"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105339"><a href="#local-6989586621679105339"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105340"><a href="#local-6989586621679105340"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105339"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679105338"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105340"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>  </span><a href="Lang.L5.Data.html#FunE"><span class="hs-identifier hs-var">L5.FunE</span></a><span> </span><a name="local-6989586621679105341"><a href="#local-6989586621679105341"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105342"><a href="#local-6989586621679105342"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679105341"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105342"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>  </span><a href="Lang.L5.Data.html#AppE"><span class="hs-identifier hs-var">L5.AppE</span></a><span> </span><a name="local-6989586621679105343"><a href="#local-6989586621679105343"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105344"><a href="#local-6989586621679105344"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105343"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105344"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-identifier">testX2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-151"></a><a name="testX2"><a href="HW06.html#testX2"><span class="hs-identifier">testX2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X2&quot;</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;freeVarsExpr&quot;</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span>
</span><a name="line-155"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/x2&quot;</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pSet"><span class="hs-identifier hs-var">pSet</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">----------</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- [X3] --</span><span>
</span><a name="line-161"></a><span class="hs-comment">----------</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-identifier">freeVarsVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L5.Data.html#ValueS"><span class="hs-identifier hs-type">L5.ValueS</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-164"></a><a name="freeVarsVal"><a href="HW06.html#freeVarsVal"><span class="hs-identifier">freeVarsVal</span></a></a><span> </span><a name="local-6989586621679105345"><a href="#local-6989586621679105345"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105345"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-165"></a><span>  </span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105346"><a href="#local-6989586621679105346"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-166"></a><span>  </span><a href="Lang.L5.Data.html#BoolSV"><span class="hs-identifier hs-var">L5.BoolSV</span></a><span> </span><a name="local-6989586621679105347"><a href="#local-6989586621679105347"><span class="hs-identifier">_b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-167"></a><span>  </span><a href="Lang.L5.Data.html#FunSV"><span class="hs-identifier hs-var">L5.FunSV</span></a><span> </span><a name="local-6989586621679105348"><a href="#local-6989586621679105348"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105349"><a href="#local-6989586621679105349"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679105348"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#freeVarsExpr"><span class="hs-identifier hs-var">freeVarsExpr</span></a><span> </span><a href="#local-6989586621679105349"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">testX3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-170"></a><a name="testX3"><a href="HW06.html#testX3"><span class="hs-identifier">testX3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X3&quot;</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;freeVarsVal&quot;</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#freeVarsVal"><span class="hs-identifier hs-var">freeVarsVal</span></a><span>
</span><a name="line-174"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/x3&quot;</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L5.Util.html#pValueS"><span class="hs-identifier hs-var">L5.pValueS</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pSet"><span class="hs-identifier hs-var">pSet</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- [E1]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-184"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- Implement substitution of values inside of expressions in L5, the language</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- with first class functions.</span><span>
</span><a name="line-188"></a><span class="hs-comment">--</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- `substValue x v e` should replace all free occurrences of the variable `x`</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- with `v` inside the expression `e`. This operation is notated `[v/x]e` in</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- math.</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- A full specification for this function is in the course notes, and</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- reproduced here in unicode:</span><span>
</span><a name="line-195"></a><span class="hs-comment">--</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- [_/_]_ &#8712; value &#215; var &#215; expr &#8594; expr</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- [v/x]i &#8796; i</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- [v/x](e&#8321; + e&#8322;) &#8796; [v/x]e&#8321; + [v/x]e&#8322;</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- [v/x](e&#8321; * e&#8322;) &#8796; [v/x]e&#8321; * [v/x]e&#8322;</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- [v/x]b &#8796; b</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- [v/x](if e&#8321; then e&#8322; else e&#8323;) &#8796; if [v/x]e&#8321; then [v/x]e&#8322; else [v/x]e&#8323;</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- [v/x]y &#8796; v    when x = y</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- [v/x]y &#8796; y    when x &#8800; y</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- [v/x](let y = e&#8321; in e&#8322;) &#8796; let y = [v/x]e&#8321; in e&#8322;         when x = y</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- [v/x](let y = e&#8321; in e&#8322;) &#8796; let y = [v/x]e&#8321; in [v/x]e&#8322;    when x &#8800; y</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- [v/x](fun y &#8658; e) &#8796; fun y &#8658; e         when x = y</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- [v/x](fun y &#8658; e) &#8796; fun y &#8658; [v/x]e    when x &#8800; y</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- [v/x](e&#8321; e&#8322;) &#8796; [v/x]e&#8321; [v/x]e&#8322;</span><span>
</span><a name="line-209"></a><span class="hs-comment">--</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- - Use `exprFromValue` (X1) to convert from a value to an expression in the</span><span>
</span><a name="line-212"></a><span class="hs-comment">--   `VarE` case</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- - Don't forget to cover all of the cases! If the above definition is</span><span>
</span><a name="line-214"></a><span class="hs-comment">--   undefined anywhere, your Haskell function should return `bad`.</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-identifier">substValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueS"><span class="hs-identifier hs-type">L5.ValueS</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span>
</span><a name="line-217"></a><a name="substValue"><a href="HW06.html#substValue"><span class="hs-identifier">substValue</span></a></a><span> </span><a name="local-6989586621679105350"><a href="#local-6989586621679105350"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105351"><a href="#local-6989586621679105351"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679105352"><a href="#local-6989586621679105352"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105352"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>  </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a name="local-6989586621679105353"><a href="#local-6989586621679105353"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a href="#local-6989586621679105353"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-219"></a><span>  </span><a href="Lang.L5.Data.html#PlusE"><span class="hs-identifier hs-var">L5.PlusE</span></a><span> </span><a name="local-6989586621679105354"><a href="#local-6989586621679105354"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105355"><a href="#local-6989586621679105355"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#PlusE"><span class="hs-identifier hs-var">L5.PlusE</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105354"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105355"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>  </span><a href="Lang.L5.Data.html#TimesE"><span class="hs-identifier hs-var">L5.TimesE</span></a><span> </span><a name="local-6989586621679105356"><a href="#local-6989586621679105356"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105357"><a href="#local-6989586621679105357"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#TimesE"><span class="hs-identifier hs-var">L5.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105356"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105357"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>  </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a name="local-6989586621679105358"><a href="#local-6989586621679105358"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a href="#local-6989586621679105358"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-222"></a><span>  </span><a href="Lang.L5.Data.html#IfE"><span class="hs-identifier hs-var">L5.IfE</span></a><span> </span><a name="local-6989586621679105359"><a href="#local-6989586621679105359"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105360"><a href="#local-6989586621679105360"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679105361"><a href="#local-6989586621679105361"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#IfE"><span class="hs-identifier hs-var">L5.IfE</span></a><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105359"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105360"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679105361"><span class="hs-identifier hs-var">e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>  </span><a href="Lang.L5.Data.html#VarE"><span class="hs-identifier hs-var">L5.VarE</span></a><span> </span><a name="local-6989586621679105362"><a href="#local-6989586621679105362"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679105350"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679105362"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-225"></a><span>       </span><span class="hs-keyword">then</span><span> </span><a href="HW06.html#exprFromValue"><span class="hs-identifier hs-var">exprFromValue</span></a><span> </span><a href="#local-6989586621679105351"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-226"></a><span>       </span><span class="hs-keyword">else</span><span> </span><a href="Lang.L5.Data.html#VarE"><span class="hs-identifier hs-var">L5.VarE</span></a><span> </span><a href="#local-6989586621679105362"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-227"></a><span>  </span><a href="Lang.L5.Data.html#LetE"><span class="hs-identifier hs-var">L5.LetE</span></a><span> </span><a name="local-6989586621679105363"><a href="#local-6989586621679105363"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679105364"><a href="#local-6989586621679105364"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105365"><a href="#local-6989586621679105365"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-228"></a><span>  </span><a href="Lang.L5.Data.html#FunE"><span class="hs-identifier hs-var">L5.FunE</span></a><span> </span><a name="local-6989586621679105380"><a href="#local-6989586621679105380"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679105381"><a href="#local-6989586621679105381"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-229"></a><span>  </span><a href="Lang.L5.Data.html#AppE"><span class="hs-identifier hs-var">L5.AppE</span></a><span> </span><a name="local-6989586621679105382"><a href="#local-6989586621679105382"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105383"><a href="#local-6989586621679105383"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-identifier">testE1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-232"></a><a name="testE1"><a href="HW06.html#testE1"><span class="hs-identifier">testE1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;substValue&quot;</span><span>
</span><a name="line-235"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="HW06.html#substValue"><span class="hs-identifier hs-var">substValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/e1&quot;</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span> </span><a href="Lang.L5.Util.html#pValueS"><span class="hs-identifier hs-var">L5.pValueS</span></a><span class="hs-special">)</span><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span class="hs-special">)</span><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span>
</span><a name="line-238"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- [E2]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-242"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- Implement a substitution-based interpreter for L5, the language with first</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- class functions.</span><span>
</span><a name="line-246"></a><span class="hs-comment">--</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- `interpWithSubst e` should evaluate to the result of interpreting the</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- expression `e`. This operation is notated `&#10214;e&#10215;` in math.</span><span>
</span><a name="line-249"></a><span class="hs-comment">--</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- A full specification for this function is in the course notes, and</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- reproduced here in unicode:</span><span>
</span><a name="line-252"></a><span class="hs-comment">--</span><span>
</span><a name="line-253"></a><span class="hs-comment">-- &#10214;_&#10215; &#8712; expr &#8594; answer</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- &#10214;i&#10215; &#8796; i</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- &#10214;e&#8321; + e&#8322;&#10215; &#8796; i&#8321; + i&#8322;</span><span>
</span><a name="line-256"></a><span class="hs-comment">--   where i&#8321; = &#10214;e&#8321;&#10215;</span><span>
</span><a name="line-257"></a><span class="hs-comment">--         i&#8322; = &#10214;e&#8322;&#10215;</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- &#10214;e&#8321; * e&#8322;&#10215; &#8796; i&#8321; * i&#8322;</span><span>
</span><a name="line-259"></a><span class="hs-comment">--   where i&#8321; = &#10214;e&#8321;&#10215;</span><span>
</span><a name="line-260"></a><span class="hs-comment">--         i&#8322; = &#10214;e&#8322;&#10215;</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- &#10214;b&#10215; &#8796; b</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215; &#8796; &#10214;e&#8322;&#10215;    if &#10214;e&#8321;&#10215; = true</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215; &#8796; &#10214;e&#8323;&#10215;    if &#10214;e&#8321;&#10215; = false</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- &#10214;let x = e&#8321; in e&#8322;&#10215; &#8796; &#10214;[v/x]e&#8322;&#10215;</span><span>
</span><a name="line-265"></a><span class="hs-comment">--   where v = &#10214;e&#8321;&#10215;</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- &#10214;fun x &#8658; e&#10215; &#8796; fun x &#8658; e    if FV(e) &#8838; {x}</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- &#10214;e&#8321; e&#8322;&#10215; &#8796; &#10214;[v/x]e&#8242;&#10215;</span><span>
</span><a name="line-268"></a><span class="hs-comment">--   where fun x &#8658; e&#8242; = &#10214;e&#8321;&#10215;</span><span>
</span><a name="line-269"></a><span class="hs-comment">--         v          = &#10214;e&#8322;&#10215;</span><span>
</span><a name="line-270"></a><span class="hs-comment">--</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- - Note that the usual constructors `ValueA`, `IntV`, etc. are renamed to</span><span>
</span><a name="line-273"></a><span class="hs-comment">--   `ValueSA` and `IntSV`, where the mnemonic is &#8220;Value Substitution-based</span><span>
</span><a name="line-274"></a><span class="hs-comment">--   Answer&#8221; and &#8220;Int Substitution-based Value&#8221;, and they are so named to</span><span>
</span><a name="line-275"></a><span class="hs-comment">--   distinguish them from the environment-based answers and values.</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- - Use `freeVarsExpr` (X2) to compute the free varaibles check in the `fun y &#8658; e`</span><span>
</span><a name="line-277"></a><span class="hs-comment">--   case.</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- - Use `Set.isSubsetOf :: Set a -&gt; Set a -&gt; Bool` to check if one set is a</span><span>
</span><a name="line-279"></a><span class="hs-comment">--   subset (&#8838;) of another.</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- - Don't forget to cover all of the cases! If the above definition is</span><span>
</span><a name="line-281"></a><span class="hs-comment">--   undefined anywhere, your Haskell function should return `bad`.</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">interpWithSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#AnswerS"><span class="hs-identifier hs-type">L5.AnswerS</span></a><span>
</span><a name="line-284"></a><a name="interpWithSubst"><a href="HW06.html#interpWithSubst"><span class="hs-identifier">interpWithSubst</span></a></a><span> </span><a name="local-6989586621679105400"><a href="#local-6989586621679105400"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105400"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-285"></a><span>  </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a name="local-6989586621679105401"><a href="#local-6989586621679105401"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a href="#local-6989586621679105401"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>  </span><a href="Lang.L5.Data.html#PlusE"><span class="hs-identifier hs-var">L5.PlusE</span></a><span> </span><a name="local-6989586621679105402"><a href="#local-6989586621679105402"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105403"><a href="#local-6989586621679105403"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105402"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105403"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-287"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105404"><a href="#local-6989586621679105404"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105405"><a href="#local-6989586621679105405"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105404"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679105405"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadSA"><span class="hs-identifier hs-var">L5.BadSA</span></a><span>
</span><a name="line-289"></a><span>  </span><a href="Lang.L5.Data.html#TimesE"><span class="hs-identifier hs-var">L5.TimesE</span></a><span> </span><a name="local-6989586621679105406"><a href="#local-6989586621679105406"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105407"><a href="#local-6989586621679105407"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105406"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105407"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-290"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105408"><a href="#local-6989586621679105408"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><a name="local-6989586621679105409"><a href="#local-6989586621679105409"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntSV"><span class="hs-identifier hs-var">L5.IntSV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105408"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679105409"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadSA"><span class="hs-identifier hs-var">L5.BadSA</span></a><span>
</span><a name="line-292"></a><span>  </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a name="local-6989586621679105410"><a href="#local-6989586621679105410"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#BoolSV"><span class="hs-identifier hs-var">L5.BoolSV</span></a><span> </span><a href="#local-6989586621679105410"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>  </span><a href="Lang.L5.Data.html#IfE"><span class="hs-identifier hs-var">L5.IfE</span></a><span> </span><a name="local-6989586621679105411"><a href="#local-6989586621679105411"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105412"><a href="#local-6989586621679105412"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679105413"><a href="#local-6989586621679105413"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105411"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-294"></a><span>    </span><a href="Lang.L5.Data.html#ValueSA"><span class="hs-identifier hs-var">L5.ValueSA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#BoolSV"><span class="hs-identifier hs-var">L5.BoolSV</span></a><span> </span><a name="local-6989586621679105414"><a href="#local-6989586621679105414"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-295"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679105414"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-296"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105412"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-297"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span> </span><a href="#local-6989586621679105413"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-298"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadSA"><span class="hs-identifier hs-var">L5.BadSA</span></a><span>
</span><a name="line-299"></a><span>  </span><a href="Lang.L5.Data.html#VarE"><span class="hs-identifier hs-var">L5.VarE</span></a><span> </span><a name="local-6989586621679105415"><a href="#local-6989586621679105415"><span class="hs-identifier">_x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadSA"><span class="hs-identifier hs-var">L5.BadSA</span></a><span>
</span><a name="line-300"></a><span>  </span><a href="Lang.L5.Data.html#LetE"><span class="hs-identifier hs-var">L5.LetE</span></a><span> </span><a name="local-6989586621679105416"><a href="#local-6989586621679105416"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105417"><a href="#local-6989586621679105417"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105418"><a href="#local-6989586621679105418"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-301"></a><span>  </span><a href="Lang.L5.Data.html#FunE"><span class="hs-identifier hs-var">L5.FunE</span></a><span> </span><a name="local-6989586621679105419"><a href="#local-6989586621679105419"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105420"><a href="#local-6989586621679105420"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-302"></a><span>  </span><a href="Lang.L5.Data.html#AppE"><span class="hs-identifier hs-var">L5.AppE</span></a><span> </span><a name="local-6989586621679105421"><a href="#local-6989586621679105421"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105422"><a href="#local-6989586621679105422"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-identifier">testE2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-305"></a><a name="testE2"><a href="HW06.html#testE2"><span class="hs-identifier">testE2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-306"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpWithSubst&quot;</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithSubst"><span class="hs-identifier hs-var">interpWithSubst</span></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/e2&quot;</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span> </span><a href="Lang.L5.Util.html#pAnswerS"><span class="hs-identifier hs-var">L5.pAnswerS</span></a><span>
</span><a name="line-311"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- [E3]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-315"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">-- Implement an environment-based interpreter for L5, the language with first</span><span>
</span><a name="line-318"></a><span class="hs-comment">-- class functions.</span><span>
</span><a name="line-319"></a><span class="hs-comment">--</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- `interpWithEnv env e` should evaluate the expression `e` inside of the</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- (delayed substitution) environment `env`. This operation is written `&#10214;e&#10215;(&#947;)`</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- in math where `&#947;` is the environment `env`.</span><span>
</span><a name="line-323"></a><span class="hs-comment">--</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- A full specification for this function is in the course notes, and</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- reproduced here in unicode:</span><span>
</span><a name="line-326"></a><span class="hs-comment">--</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- &#10214;_&#10215; &#8712; expr &#8594; env &#8594; answer</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- &#10214;i&#10215;(&#947;) &#8796; i</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- &#10214;e&#8321; + e&#8322;&#10215;(&#947;) &#8796; i&#8321; + i&#8322;</span><span>
</span><a name="line-330"></a><span class="hs-comment">--   where i&#8321; = &#10214;e&#8321;&#10215;(&#947;)</span><span>
</span><a name="line-331"></a><span class="hs-comment">--         i&#8322; = &#10214;e&#8322;&#10215;(&#947;)</span><span>
</span><a name="line-332"></a><span class="hs-comment">-- &#10214;e&#8321; * e&#8322;&#10215;(&#947;) &#8796; i&#8321; * i&#8322;</span><span>
</span><a name="line-333"></a><span class="hs-comment">--   where i&#8321; = &#10214;e&#8321;&#10215;(&#947;)</span><span>
</span><a name="line-334"></a><span class="hs-comment">--         i&#8322; = &#10214;e&#8322;&#10215;(&#947;)</span><span>
</span><a name="line-335"></a><span class="hs-comment">-- &#10214;b&#10215;(&#947;) &#8796; b</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215;(&#947;) &#8796; &#10214;e&#8322;&#10215;(&#947;)    if &#10214;e&#8321;&#10215;(&#947;) = true</span><span>
</span><a name="line-337"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215;(&#947;) &#8796; &#10214;e&#8323;&#10215;(&#947;)    if &#10214;e&#8321;&#10215;(&#947;) = false</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- &#10214;let x = e&#8321; in e&#8322;&#10215;(&#947;) &#8796; &#10214;e&#8322;&#10215;(&#947;[x&#8614;v])</span><span>
</span><a name="line-339"></a><span class="hs-comment">--   where v = &#10214;e&#8321;&#10215;(&#947;)</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- &#10214;fun x &#8658; e&#10215; &#8796; &#10216;fun x &#8658; e, &#947;&#10217;</span><span>
</span><a name="line-341"></a><span class="hs-comment">-- &#10214;e&#8321; e&#8322;&#10215; &#8796; &#10214;e&#8242;&#10215;(&#947;&#8242;[x&#8614;v])</span><span>
</span><a name="line-342"></a><span class="hs-comment">--   where &#10216;fun x &#8658; e&#8242;, &#947;&#8242;&#10217; = &#10214;e&#8321;&#10215;(&#947;)</span><span>
</span><a name="line-343"></a><span class="hs-comment">--         v                = &#10214;e&#8322;&#10215;(&#947;)</span><span>
</span><a name="line-344"></a><span class="hs-comment">--</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- - Don't forget to cover all of the cases! If the above definition is</span><span>
</span><a name="line-347"></a><span class="hs-comment">--   undefined anywhere, your Haskell function should return `bad`.</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">interpWithEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L5.Data.html#EnvE"><span class="hs-identifier hs-type">L5.EnvE</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#Expr"><span class="hs-identifier hs-type">L5.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#AnswerE"><span class="hs-identifier hs-type">L5.AnswerE</span></a><span>
</span><a name="line-350"></a><a name="interpWithEnv"><a href="HW06.html#interpWithEnv"><span class="hs-identifier">interpWithEnv</span></a></a><span> </span><a name="local-6989586621679105423"><a href="#local-6989586621679105423"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679105424"><a href="#local-6989586621679105424"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105424"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-351"></a><span>  </span><a href="Lang.L5.Data.html#IntE"><span class="hs-identifier hs-var">L5.IntE</span></a><span> </span><a name="local-6989586621679105425"><a href="#local-6989586621679105425"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><a href="#local-6989586621679105425"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>  </span><a href="Lang.L5.Data.html#PlusE"><span class="hs-identifier hs-var">L5.PlusE</span></a><span> </span><a name="local-6989586621679105426"><a href="#local-6989586621679105426"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105427"><a href="#local-6989586621679105427"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105426"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105427"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-353"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><a name="local-6989586621679105428"><a href="#local-6989586621679105428"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><a name="local-6989586621679105429"><a href="#local-6989586621679105429"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105428"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679105429"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadEA"><span class="hs-identifier hs-var">L5.BadEA</span></a><span>
</span><a name="line-355"></a><span>  </span><a href="Lang.L5.Data.html#TimesE"><span class="hs-identifier hs-var">L5.TimesE</span></a><span> </span><a name="local-6989586621679105430"><a href="#local-6989586621679105430"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105431"><a href="#local-6989586621679105431"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105430"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105431"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-356"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><a name="local-6989586621679105432"><a href="#local-6989586621679105432"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><a name="local-6989586621679105433"><a href="#local-6989586621679105433"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#IntEV"><span class="hs-identifier hs-var">L5.IntEV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105432"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679105433"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadEA"><span class="hs-identifier hs-var">L5.BadEA</span></a><span>
</span><a name="line-358"></a><span>  </span><a href="Lang.L5.Data.html#BoolE"><span class="hs-identifier hs-var">L5.BoolE</span></a><span> </span><a name="local-6989586621679105434"><a href="#local-6989586621679105434"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#BoolEV"><span class="hs-identifier hs-var">L5.BoolEV</span></a><span> </span><a href="#local-6989586621679105434"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>  </span><a href="Lang.L5.Data.html#IfE"><span class="hs-identifier hs-var">L5.IfE</span></a><span> </span><a name="local-6989586621679105435"><a href="#local-6989586621679105435"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105436"><a href="#local-6989586621679105436"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679105437"><a href="#local-6989586621679105437"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105435"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-360"></a><span>    </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L5.Data.html#BoolEV"><span class="hs-identifier hs-var">L5.BoolEV</span></a><span> </span><a name="local-6989586621679105438"><a href="#local-6989586621679105438"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-361"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679105438"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-362"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105436"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-363"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679105437"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-364"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadEA"><span class="hs-identifier hs-var">L5.BadEA</span></a><span>
</span><a name="line-365"></a><span>  </span><a href="Lang.L5.Data.html#VarE"><span class="hs-identifier hs-var">L5.VarE</span></a><span> </span><a name="local-6989586621679105439"><a href="#local-6989586621679105439"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679105439"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105423"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679105440"><a href="#local-6989586621679105440"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#ValueEA"><span class="hs-identifier hs-var">L5.ValueEA</span></a><span> </span><a href="#local-6989586621679105440"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-367"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L5.Data.html#BadEA"><span class="hs-identifier hs-var">L5.BadEA</span></a><span>
</span><a name="line-368"></a><span>  </span><a href="Lang.L5.Data.html#LetE"><span class="hs-identifier hs-var">L5.LetE</span></a><span> </span><a name="local-6989586621679105441"><a href="#local-6989586621679105441"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105442"><a href="#local-6989586621679105442"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105443"><a href="#local-6989586621679105443"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-369"></a><span>  </span><a href="Lang.L5.Data.html#FunE"><span class="hs-identifier hs-var">L5.FunE</span></a><span> </span><a name="local-6989586621679105444"><a href="#local-6989586621679105444"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105445"><a href="#local-6989586621679105445"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-370"></a><span>  </span><a href="Lang.L5.Data.html#AppE"><span class="hs-identifier hs-var">L5.AppE</span></a><span> </span><a name="local-6989586621679105446"><a href="#local-6989586621679105446"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679105447"><a href="#local-6989586621679105447"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-identifier">testE3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-373"></a><a name="testE3"><a href="HW06.html#testE3"><span class="hs-identifier">testE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-375"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpWithEnv&quot;</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#interpWithEnv"><span class="hs-identifier hs-var">interpWithEnv</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-377"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw06/e3&quot;</span><span>
</span><a name="line-378"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L5.Util.html#pExpr"><span class="hs-identifier hs-var">L5.pExpr</span></a><span> </span><a href="Lang.L5.Util.html#pAnswerE"><span class="hs-identifier hs-var">L5.pAnswerE</span></a><span>
</span><a name="line-379"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-382"></a><a name="main"><a href="HW06.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#runTests"><span class="hs-identifier hs-var">runTests</span></a><span>
</span><a name="line-383"></a><span>  </span><span class="hs-comment">-- examples</span><span>
</span><a name="line-384"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="HW06.html#testX1"><span class="hs-identifier hs-var">testX1</span></a><span>
</span><a name="line-385"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#testX2"><span class="hs-identifier hs-var">testX2</span></a><span>
</span><a name="line-386"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#testX3"><span class="hs-identifier hs-var">testX3</span></a><span>
</span><a name="line-387"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-388"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#testE1"><span class="hs-identifier hs-var">testE1</span></a><span>
</span><a name="line-389"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#testE2"><span class="hs-identifier hs-var">testE2</span></a><span>
</span><a name="line-390"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW06.html#testE3"><span class="hs-identifier hs-var">testE3</span></a><span>
</span><a name="line-391"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-392"></a></pre></body></html>