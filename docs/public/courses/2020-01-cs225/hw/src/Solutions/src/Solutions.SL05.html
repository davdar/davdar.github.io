<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Solutions.SL05</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Testing</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Lex</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Lang.L4</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L4</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">----------</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- [X1] --</span><span>
</span><a name="line-53"></a><span class="hs-comment">----------</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- Find the value associated with Walter in the map and add 1 to the result.</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">findWalterAddOne</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-58"></a><a name="findWalterAddOne"><a href="Solutions.SL05.html#findWalterAddOne"><span class="hs-identifier">findWalterAddOne</span></a></a><span> </span><a name="local-6989586621679027832"><a href="#local-6989586621679027832"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-string">&quot;Walter&quot;</span><span> </span><a href="#local-6989586621679027832"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679027833"><a href="#local-6989586621679027833"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027833"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-identifier">testX1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-63"></a><a name="testX1"><a href="Solutions.SL05.html#testX1"><span class="hs-identifier">testX1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1&quot;</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;findWalterAddOne&quot;</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#findWalterAddOne"><span class="hs-identifier hs-var">findWalterAddOne</span></a><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/x1&quot;</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMap</span><span> </span><span class="hs-identifier hs-var">pVar</span><span> </span><span class="hs-identifier hs-var">pInt</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMaybe</span><span> </span><span class="hs-identifier hs-var">pInt</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">----------</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- [X2] -- </span><span>
</span><a name="line-73"></a><span class="hs-comment">----------</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- Write an interpreter for commands. A command just adds a new function</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- definition to the function environment.</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-identifier">interpCommand</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Command</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span>
</span><a name="line-79"></a><a name="interpCommand"><a href="Solutions.SL05.html#interpCommand"><span class="hs-identifier">interpCommand</span></a></a><span> </span><a name="local-6989586621679027938"><a href="#local-6989586621679027938"><span class="hs-identifier">fenv</span></a></a><span> </span><a name="local-6989586621679027939"><a href="#local-6989586621679027939"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679027939"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-identifier hs-var">L4.DefC</span><span> </span><a name="local-6989586621679027940"><a href="#local-6989586621679027940"><span class="hs-identifier">fx</span></a></a><span> </span><a name="local-6989586621679027941"><a href="#local-6989586621679027941"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679027942"><a href="#local-6989586621679027942"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679027940"><span class="hs-identifier hs-var">fx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027941"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679027942"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027938"><span class="hs-identifier hs-var">fenv</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">testX2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-83"></a><a name="testX2"><a href="Solutions.SL05.html#testX2"><span class="hs-identifier">testX2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X2&quot;</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpCommand&quot;</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL05.html#interpCommand"><span class="hs-identifier hs-var">interpCommand</span></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/x2&quot;</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-identifier hs-var">L4.pFEnv</span><span> </span><span class="hs-identifier hs-var">L4.pCommand</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L4.pFEnv</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">----------</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- [X3] --</span><span>
</span><a name="line-93"></a><span class="hs-comment">----------</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- Combine words from two lists pairwise by adding a hyphen between pairwise</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- entries. You may find this helpful for E2.</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-identifier">combineWords</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-99"></a><a name="combineWords"><a href="Solutions.SL05.html#combineWords"><span class="hs-identifier">combineWords</span></a></a><span> </span><a name="local-6989586621679027959"><a href="#local-6989586621679027959"><span class="hs-identifier">ss1</span></a></a><span> </span><a name="local-6989586621679027960"><a href="#local-6989586621679027960"><span class="hs-identifier">ss2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027959"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-special">,</span><a href="#local-6989586621679027960"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679027961"><a href="#local-6989586621679027961"><span class="hs-identifier">s1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027962"><a href="#local-6989586621679027962"><span class="hs-identifier">ss1'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679027963"><a href="#local-6989586621679027963"><span class="hs-identifier">s2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027964"><a href="#local-6989586621679027964"><span class="hs-identifier">ss2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#combineWords"><span class="hs-identifier hs-var">combineWords</span></a><span> </span><a href="#local-6989586621679027962"><span class="hs-identifier hs-var">ss1'</span></a><span> </span><a href="#local-6989586621679027964"><span class="hs-identifier hs-var">ss2'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679027965"><a href="#local-6989586621679027965"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679027961"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679027963"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679027965"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-identifier">testX3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-109"></a><a name="testX3"><a href="Solutions.SL05.html#testX3"><span class="hs-identifier">testX3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X3&quot;</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;combineWords&quot;</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL05.html#combineWords"><span class="hs-identifier hs-var">combineWords</span></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/x3&quot;</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- ---------------</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- -- [E1]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- ---------------</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- Write a function that interprets many commands at once. Commands transform</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- an incoming function environment and add a new entry into the outgoing</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- function environment. See test cases for expected functionality.</span><span>
</span><a name="line-128"></a><span class="hs-comment">--</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- - use `interpCommand` (X2)</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- - use recursion on lists</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">interpCommandMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">L4.Command</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span>
</span><a name="line-134"></a><a name="interpCommandMany"><a href="Solutions.SL05.html#interpCommandMany"><span class="hs-identifier">interpCommandMany</span></a></a><span> </span><a name="local-6989586621679027966"><a href="#local-6989586621679027966"><span class="hs-identifier">fenv</span></a></a><span> </span><a name="local-6989586621679027967"><a href="#local-6989586621679027967"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679027967"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679027966"><span class="hs-identifier hs-var">fenv</span></a><span>
</span><a name="line-136"></a><span>  </span><a name="local-6989586621679027968"><a href="#local-6989586621679027968"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027969"><a href="#local-6989586621679027969"><span class="hs-identifier">cs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679027970"><a href="#local-6989586621679027970"><span class="hs-identifier">fenv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Solutions.SL05.html#interpCommand"><span class="hs-identifier hs-var">interpCommand</span></a><span> </span><a href="#local-6989586621679027966"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027968"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-138"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="Solutions.SL05.html#interpCommandMany"><span class="hs-identifier hs-var">interpCommandMany</span></a><span> </span><a href="#local-6989586621679027970"><span class="hs-identifier hs-var">fenv'</span></a><span> </span><a href="#local-6989586621679027969"><span class="hs-identifier hs-var">cs'</span></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">testE1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-141"></a><a name="testE1"><a href="Solutions.SL05.html#testE1"><span class="hs-identifier">testE1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpCommandMany&quot;</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL05.html#interpCommandMany"><span class="hs-identifier hs-var">interpCommandMany</span></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/e1&quot;</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-identifier hs-var">L4.pFEnv</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">L4.pCommand</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L4.pFEnv</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- [E2]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-151"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- Write a function that extends a standard environment to map a list of names</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- to a list of values. If the number of names is different from the number of</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- values, this should fail by returning `Nothing`. See test cases for expected</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- functionality.</span><span>
</span><a name="line-157"></a><span class="hs-comment">--</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- - documentation for `Map` in Haskell: https://hackage.haskell.org/package/containers/docs/Data-Map-Lazy.html</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- - look at `combineWords` (X3) for inspiration</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- - use recursion on lists</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- - use `Map.insert`</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-identifier">extendEnvMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">L4.Value</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Env</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">L4.Env</span><span>
</span><a name="line-165"></a><a name="extendEnvMany"><a href="Solutions.SL05.html#extendEnvMany"><span class="hs-identifier">extendEnvMany</span></a></a><span> </span><a name="local-6989586621679027971"><a href="#local-6989586621679027971"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679027972"><a href="#local-6989586621679027972"><span class="hs-identifier">vs</span></a></a><span> </span><a name="local-6989586621679027973"><a href="#local-6989586621679027973"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027971"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679027972"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679027973"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679027974"><a href="#local-6989586621679027974"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027975"><a href="#local-6989586621679027975"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679027976"><a href="#local-6989586621679027976"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027977"><a href="#local-6989586621679027977"><span class="hs-identifier">vs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#extendEnvMany"><span class="hs-identifier hs-var">extendEnvMany</span></a><span> </span><a href="#local-6989586621679027975"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679027977"><span class="hs-identifier hs-var">vs'</span></a><span> </span><a href="#local-6989586621679027973"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679027978"><a href="#local-6989586621679027978"><span class="hs-identifier">env'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679027974"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679027976"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679027978"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">testE2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-174"></a><a name="testE2"><a href="Solutions.SL05.html#testE2"><span class="hs-identifier">testE2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;extendEnvMany&quot;</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL05.html#extendEnvMany"><span class="hs-identifier hs-var">extendEnvMany</span></a><span>
</span><a name="line-178"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/e2&quot;</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMany</span><span> </span><span class="hs-identifier hs-var">L4.pValue</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L4.pEnv</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pMaybe</span><span> </span><span class="hs-identifier hs-var">L4.pEnv</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- [E3]: &#9733;&#9733;&#9733; --</span><span>
</span><a name="line-184"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- Write an interpreter for a language with integers, plus, times, booleans,</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- conditionals, variables, let-binding, function definitions and function</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- calls.</span><span>
</span><a name="line-189"></a><span class="hs-comment">--</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- e &#8712; expr &#10868; i | e + e | e * e | b | if e then e else e </span><span>
</span><a name="line-191"></a><span class="hs-comment">--          | x | let x = e in e</span><span>
</span><a name="line-192"></a><span class="hs-comment">--          | f(e,&#8230;,e)</span><span>
</span><a name="line-193"></a><span class="hs-comment">--</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- A helper function `interpExprMany` is provided for you which is mutually</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- recirsive with interpExpr, and will interpret multiple expressions to return</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- (maybe) multiple values.</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- A top-level driver `interp` is also provided which interprets a program by</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- first interpreting all of the commands, and then finally interpreting the</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- program expression. The test cases for this exercise are in terms of</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- `interp` (which provided to you and calls `interpExpr`), whereas you need to</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- implement `interpExpr`.</span><span>
</span><a name="line-203"></a><span class="hs-comment">--</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- - use `extendEnvMany` (E2) in CallE case</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-identifier">interpExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Env</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Answer</span><span>
</span><a name="line-208"></a><a name="interpExpr"><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier">interpExpr</span></a></a><span> </span><a name="local-6989586621679027979"><a href="#local-6989586621679027979"><span class="hs-identifier">fenv</span></a></a><span> </span><a name="local-6989586621679027980"><a href="#local-6989586621679027980"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679027981"><a href="#local-6989586621679027981"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679027981"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-identifier hs-var">L4.IntE</span><span> </span><a name="local-6989586621679027982"><a href="#local-6989586621679027982"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><a href="#local-6989586621679027982"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-identifier hs-var">L4.PlusE</span><span> </span><a name="local-6989586621679027983"><a href="#local-6989586621679027983"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679027984"><a href="#local-6989586621679027984"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027983"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027984"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><a name="local-6989586621679027985"><a href="#local-6989586621679027985"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><a name="local-6989586621679027986"><a href="#local-6989586621679027986"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027985"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679027986"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-identifier hs-var">L4.TimesE</span><span> </span><a name="local-6989586621679027987"><a href="#local-6989586621679027987"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679027988"><a href="#local-6989586621679027988"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027987"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027988"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><a name="local-6989586621679027989"><a href="#local-6989586621679027989"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><a name="local-6989586621679027990"><a href="#local-6989586621679027990"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027989"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679027990"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-identifier hs-var">L4.BoolE</span><span> </span><a name="local-6989586621679027991"><a href="#local-6989586621679027991"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.BoolV</span><span> </span><a href="#local-6989586621679027991"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-identifier hs-var">L4.IfE</span><span> </span><a name="local-6989586621679027992"><a href="#local-6989586621679027992"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679027993"><a href="#local-6989586621679027993"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679027994"><a href="#local-6989586621679027994"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027992"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>    </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.BoolV</span><span> </span><a name="local-6989586621679027995"><a href="#local-6989586621679027995"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-219"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679027995"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-220"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027993"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-221"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027994"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-222"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-identifier hs-var">L4.VarE</span><span> </span><a name="local-6989586621679027996"><a href="#local-6989586621679027996"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679027996"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679027997"><a href="#local-6989586621679027997"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><a href="#local-6989586621679027997"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-225"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-226"></a><span>  </span><span class="hs-identifier hs-var">L4.LetE</span><span> </span><a name="local-6989586621679027998"><a href="#local-6989586621679027998"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679027999"><a href="#local-6989586621679027999"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679028000"><a href="#local-6989586621679028000"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679027999"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><a name="local-6989586621679028001"><a href="#local-6989586621679028001"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679027998"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679028001"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028000"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-228"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-identifier hs-var">L4.CallE</span><span> </span><a name="local-6989586621679028002"><a href="#local-6989586621679028002"><span class="hs-identifier">fx</span></a></a><span> </span><a name="local-6989586621679028003"><a href="#local-6989586621679028003"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679028002"><span class="hs-identifier hs-var">fx</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028004"><a href="#local-6989586621679028004"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028005"><a href="#local-6989586621679028005"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#interpExprMany"><span class="hs-identifier hs-var">interpExprMany</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679027980"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679028003"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-231"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679028006"><a href="#local-6989586621679028006"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#extendEnvMany"><span class="hs-identifier hs-var">extendEnvMany</span></a><span> </span><a href="#local-6989586621679028004"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679028006"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-232"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679028007"><a href="#local-6989586621679028007"><span class="hs-identifier">env'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679027979"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679028007"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679028005"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-233"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-234"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L4.BadA</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-identifier">interpExprMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L4.FEnv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Env</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">L4.Expr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">L4.Value</span><span class="hs-special">]</span><span>
</span><a name="line-238"></a><a name="interpExprMany"><a href="Solutions.SL05.html#interpExprMany"><span class="hs-identifier">interpExprMany</span></a></a><span> </span><a name="local-6989586621679028008"><a href="#local-6989586621679028008"><span class="hs-identifier">fenv</span></a></a><span> </span><a name="local-6989586621679028009"><a href="#local-6989586621679028009"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679028010"><a href="#local-6989586621679028010"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679028010"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-240"></a><span>  </span><a name="local-6989586621679028011"><a href="#local-6989586621679028011"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028012"><a href="#local-6989586621679028012"><span class="hs-identifier">es'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679028008"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679028009"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679028011"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-identifier hs-var">L4.ValueA</span><span> </span><a name="local-6989586621679028013"><a href="#local-6989586621679028013"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL05.html#interpExprMany"><span class="hs-identifier hs-var">interpExprMany</span></a><span> </span><a href="#local-6989586621679028008"><span class="hs-identifier hs-var">fenv</span></a><span> </span><a href="#local-6989586621679028009"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679028012"><span class="hs-identifier hs-var">es'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-242"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679028014"><a href="#local-6989586621679028014"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028013"><span class="hs-identifier hs-var">v</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679028014"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-identifier hs-var">L4.BadA</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-identifier">interp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L4.Program</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L4.Answer</span><span>
</span><a name="line-247"></a><a name="interp"><a href="Solutions.SL05.html#interp"><span class="hs-identifier">interp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L4.Program</span><span> </span><a name="local-6989586621679028015"><a href="#local-6989586621679028015"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679028016"><a href="#local-6989586621679028016"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679028017"><a href="#local-6989586621679028017"><span class="hs-identifier">fenv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Solutions.SL05.html#interpCommandMany"><span class="hs-identifier hs-var">interpCommandMany</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><a href="#local-6989586621679028015"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Solutions.SL05.html#interpExpr"><span class="hs-identifier hs-var">interpExpr</span></a><span> </span><a href="#local-6989586621679028017"><span class="hs-identifier hs-var">fenv'</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><a href="#local-6989586621679028016"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">testE3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-252"></a><a name="testE3"><a href="Solutions.SL05.html#testE3"><span class="hs-identifier">testE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interp&quot;</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#interp"><span class="hs-identifier hs-var">interp</span></a><span>
</span><a name="line-256"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw05/e3&quot;</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-identifier hs-var">L4.pProgram</span><span> </span><span class="hs-identifier hs-var">L4.pAnswer</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a><a name="main"><a href="Solutions.SL05.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runTests</span><span>
</span><a name="line-262"></a><span>  </span><span class="hs-comment">-- examples</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="Solutions.SL05.html#testX1"><span class="hs-identifier hs-var">testX1</span></a><span>
</span><a name="line-264"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#testX2"><span class="hs-identifier hs-var">testX2</span></a><span>
</span><a name="line-265"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#testX3"><span class="hs-identifier hs-var">testX3</span></a><span>
</span><a name="line-266"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#testE1"><span class="hs-identifier hs-var">testE1</span></a><span>
</span><a name="line-268"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#testE2"><span class="hs-identifier hs-var">testE2</span></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL05.html#testE3"><span class="hs-identifier hs-var">testE3</span></a><span>
</span><a name="line-270"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-271"></a></pre></body></html>