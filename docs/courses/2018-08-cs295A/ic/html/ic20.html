<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ic20</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="ic20.html" class="Module">ic20</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Basics-v7.html" class="Module">Basics-v7</a>

<a id="43" class="Keyword">data</a> <a id="exp"></a><a id="48" href="ic20.html#48" class="Datatype">exp</a> <a id="52" class="Symbol">(</a><a id="53" href="ic20.html#53" class="Bound">N</a> <a id="55" class="Symbol">:</a> <a id="57" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="58" class="Symbol">)</a> <a id="60" class="Symbol">:</a> <a id="62" class="PrimitiveType">Set</a> <a id="66" class="Keyword">where</a>

<a id="73" class="Keyword">instance</a>
  <a id="has[+][exp]"></a><a id="84" href="ic20.html#84" class="Function">has[+][exp]</a> <a id="96" class="Symbol">:</a> <a id="98" class="Symbol">∀</a> <a id="100" class="Symbol">{</a><a id="101" href="ic20.html#101" class="Bound">N</a><a id="102" class="Symbol">}</a> <a id="104" class="Symbol">→</a> <a id="106" href="Basics-v7.html#2390" class="Record">has[+]</a> <a id="113" class="Symbol">(</a><a id="114" href="ic20.html#48" class="Datatype">exp</a> <a id="118" href="ic20.html#101" class="Bound">N</a><a id="119" class="Symbol">)</a>
  <a id="123" href="ic20.html#84" class="Function">has[+][exp]</a> <a id="135" class="Symbol">=</a> <a id="137" class="Keyword">record</a> <a id="144" class="Symbol">{</a> <a id="146" class="Field">zero</a> <a id="151" class="Symbol">=</a> <a id="153" class="Symbol">{!!}</a> <a id="158" class="Symbol">;</a> <a id="160" class="Field Operator">_+_</a> <a id="164" class="Symbol">=</a> <a id="166" class="Symbol">{!!}</a> <a id="171" class="Symbol">}</a>

  <a id="has[*][exp]"></a><a id="176" href="ic20.html#176" class="Function">has[*][exp]</a> <a id="188" class="Symbol">:</a> <a id="190" class="Symbol">∀</a> <a id="192" class="Symbol">{</a><a id="193" href="ic20.html#193" class="Bound">N</a><a id="194" class="Symbol">}</a> <a id="196" class="Symbol">→</a> <a id="198" href="Basics-v7.html#3058" class="Record">has[*]</a> <a id="205" class="Symbol">(</a><a id="206" href="ic20.html#48" class="Datatype">exp</a> <a id="210" href="ic20.html#193" class="Bound">N</a><a id="211" class="Symbol">)</a>
  <a id="215" href="ic20.html#176" class="Function">has[*][exp]</a> <a id="227" class="Symbol">=</a> <a id="229" class="Keyword">record</a> <a id="236" class="Symbol">{</a> <a id="238" class="Field">one</a> <a id="242" class="Symbol">=</a> <a id="244" class="Symbol">{!!}</a> <a id="249" class="Symbol">;</a> <a id="251" class="Field Operator">_*_</a> <a id="255" class="Symbol">=</a> <a id="257" class="Symbol">{!!}</a> <a id="262" class="Symbol">}</a>

<a id="⟦_⟧"></a><a id="265" href="ic20.html#265" class="Function Operator">⟦_⟧</a> <a id="269" class="Symbol">:</a> <a id="271" class="Symbol">∀</a> <a id="273" class="Symbol">{</a><a id="274" href="ic20.html#274" class="Bound">N</a><a id="275" class="Symbol">}</a> <a id="277" class="Symbol">→</a> <a id="279" href="ic20.html#48" class="Datatype">exp</a> <a id="283" href="ic20.html#274" class="Bound">N</a> <a id="285" class="Symbol">→</a> <a id="287" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="292" href="ic20.html#274" class="Bound">N</a> <a id="294" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="296" href="Basics-v7.html#15798" class="Datatype">ℕ</a> <a id="298" class="Symbol">→</a> <a id="300" href="Basics-v7.html#15798" class="Datatype">ℕ</a>
<a id="302" href="ic20.html#265" class="Function Operator">⟦</a> <a id="304" href="ic20.html#304" class="Bound">e</a> <a id="306" href="ic20.html#265" class="Function Operator">⟧</a> <a id="308" href="ic20.html#308" class="Bound">γ</a> <a id="310" class="Symbol">=</a> <a id="312" class="Symbol">{!!}</a>

<a id="318" class="Comment">-- _ : ∀ x → x + x ≡ ⟦ Var (𝕚 0) + Var (𝕚 0) ⟧ [ x ] </a>
<a id="372" class="Comment">-- _ = λ x → refl</a>
<a id="390" class="Comment">-- </a>
<a id="394" class="Comment">-- _ : ∀ x y → (x + y) * x ≡ ⟦ (Var (𝕚 0) + Var (𝕚 1)) * Var (𝕚 0) ⟧ [ x , y ] </a>
<a id="474" class="Comment">-- _ = λ x y → refl</a>

<a id="nf*⟦_⟧"></a><a id="495" href="ic20.html#495" class="Function Operator">nf*⟦_⟧</a> <a id="502" class="Symbol">:</a> <a id="504" class="Symbol">∀</a> <a id="506" class="Symbol">{</a><a id="507" href="ic20.html#507" class="Bound">N</a><a id="508" class="Symbol">}</a> <a id="510" class="Symbol">→</a> <a id="512" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="516" class="Symbol">(</a><a id="517" href="Basics-v7.html#27783" class="Datatype">idx</a> <a id="521" href="ic20.html#507" class="Bound">N</a><a id="522" class="Symbol">)</a> <a id="524" class="Symbol">→</a> <a id="526" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="531" href="ic20.html#507" class="Bound">N</a> <a id="533" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="535" href="Basics-v7.html#15798" class="Datatype">ℕ</a> <a id="537" class="Symbol">→</a> <a id="539" href="Basics-v7.html#15798" class="Datatype">ℕ</a>
<a id="541" href="ic20.html#495" class="Function Operator">nf*⟦</a> <a id="546" href="ic20.html#546" class="Bound">xs</a> <a id="549" href="ic20.html#495" class="Function Operator">⟧</a> <a id="551" href="ic20.html#551" class="Bound">γ</a> <a id="553" class="Symbol">=</a> <a id="555" class="Symbol">{!!}</a>

<a id="nf+⟦_⟧"></a><a id="561" href="ic20.html#561" class="Function Operator">nf+⟦_⟧</a> <a id="568" class="Symbol">:</a> <a id="570" class="Symbol">∀</a> <a id="572" class="Symbol">{</a><a id="573" href="ic20.html#573" class="Bound">N</a><a id="574" class="Symbol">}</a> <a id="576" class="Symbol">→</a> <a id="578" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="582" class="Symbol">(</a><a id="583" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="587" class="Symbol">(</a><a id="588" href="Basics-v7.html#27783" class="Datatype">idx</a> <a id="592" href="ic20.html#573" class="Bound">N</a><a id="593" class="Symbol">))</a> <a id="596" class="Symbol">→</a> <a id="598" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="603" href="ic20.html#573" class="Bound">N</a> <a id="605" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="607" href="Basics-v7.html#15798" class="Datatype">ℕ</a> <a id="609" class="Symbol">→</a> <a id="611" href="Basics-v7.html#15798" class="Datatype">ℕ</a>
<a id="613" href="ic20.html#561" class="Function Operator">nf+⟦</a> <a id="618" href="ic20.html#618" class="Bound">xss</a> <a id="622" href="ic20.html#561" class="Function Operator">⟧</a> <a id="624" href="ic20.html#624" class="Bound">γ</a> <a id="626" class="Symbol">=</a> <a id="628" class="Symbol">{!!}</a>

<a id="nf-𝕟"></a><a id="634" href="ic20.html#634" class="Function">nf-𝕟</a> <a id="639" class="Symbol">:</a> <a id="641" class="Symbol">∀</a> <a id="643" class="Symbol">{</a><a id="644" href="ic20.html#644" class="Bound">N</a><a id="645" class="Symbol">}</a> <a id="647" class="Symbol">→</a> <a id="649" href="Basics-v7.html#15798" class="Datatype">ℕ</a> <a id="651" class="Symbol">→</a> <a id="653" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="657" class="Symbol">(</a><a id="658" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="662" class="Symbol">(</a><a id="663" href="Basics-v7.html#27783" class="Datatype">idx</a> <a id="667" href="ic20.html#644" class="Bound">N</a><a id="668" class="Symbol">))</a>
<a id="671" href="ic20.html#634" class="Function">nf-𝕟</a> <a id="676" href="ic20.html#676" class="Bound">n</a> <a id="678" class="Symbol">=</a> <a id="680" class="Symbol">{!!}</a>

<a id="686" class="Keyword">postulate</a>
  <a id="correct[nf-𝕟]"></a><a id="698" href="ic20.html#698" class="Postulate">correct[nf-𝕟]</a> <a id="712" class="Symbol">:</a> <a id="714" class="Symbol">∀</a> <a id="716" class="Symbol">{</a><a id="717" href="ic20.html#717" class="Bound">N</a><a id="718" class="Symbol">}</a> <a id="720" class="Symbol">(</a><a id="721" href="ic20.html#721" class="Bound">n</a> <a id="723" class="Symbol">:</a> <a id="725" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="726" class="Symbol">)</a> <a id="728" class="Symbol">(</a><a id="729" href="ic20.html#729" class="Bound">γ</a> <a id="731" class="Symbol">:</a> <a id="733" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="738" href="ic20.html#717" class="Bound">N</a> <a id="740" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="742" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="743" class="Symbol">)</a> <a id="745" class="Symbol">→</a> <a id="747" href="ic20.html#561" class="Function Operator">nf+⟦</a> <a id="752" href="ic20.html#634" class="Function">nf-𝕟</a> <a id="757" class="Symbol">{</a><a id="758" href="ic20.html#717" class="Bound">N</a><a id="759" class="Symbol">}</a> <a id="761" href="ic20.html#721" class="Bound">n</a> <a id="763" href="ic20.html#561" class="Function Operator">⟧</a> <a id="765" href="ic20.html#729" class="Bound">γ</a> <a id="767" href="Basics-v7.html#338" class="Datatype Operator">≡</a> <a id="769" href="ic20.html#721" class="Bound">n</a>

<a id="nf"></a><a id="772" href="ic20.html#772" class="Function">nf</a> <a id="775" class="Symbol">:</a> <a id="777" class="Symbol">∀</a> <a id="779" class="Symbol">{</a><a id="780" href="ic20.html#780" class="Bound">N</a><a id="781" class="Symbol">}</a> <a id="783" class="Symbol">→</a> <a id="785" href="ic20.html#48" class="Datatype">exp</a> <a id="789" href="ic20.html#780" class="Bound">N</a> <a id="791" class="Symbol">→</a> <a id="793" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="797" class="Symbol">(</a><a id="798" href="Basics-v7.html#37032" class="Datatype">bag</a> <a id="802" class="Symbol">(</a><a id="803" href="Basics-v7.html#27783" class="Datatype">idx</a> <a id="807" href="ic20.html#780" class="Bound">N</a><a id="808" class="Symbol">))</a>
<a id="811" href="ic20.html#772" class="Function">nf</a> <a id="814" href="ic20.html#814" class="Bound">e</a> <a id="816" class="Symbol">=</a> <a id="818" class="Symbol">{!!}</a>

<a id="824" class="Keyword">postulate</a>
  <a id="correct[nf]"></a><a id="836" href="ic20.html#836" class="Postulate">correct[nf]</a> <a id="848" class="Symbol">:</a> <a id="850" class="Symbol">∀</a> <a id="852" class="Symbol">{</a><a id="853" href="ic20.html#853" class="Bound">N</a><a id="854" class="Symbol">}</a> <a id="856" class="Symbol">(</a><a id="857" href="ic20.html#857" class="Bound">e</a> <a id="859" class="Symbol">:</a> <a id="861" href="ic20.html#48" class="Datatype">exp</a> <a id="865" href="ic20.html#853" class="Bound">N</a><a id="866" class="Symbol">)</a> <a id="868" class="Symbol">(</a><a id="869" href="ic20.html#869" class="Bound">γ</a> <a id="871" class="Symbol">:</a> <a id="873" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="878" href="ic20.html#853" class="Bound">N</a> <a id="880" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="882" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="883" class="Symbol">)</a> <a id="885" class="Symbol">→</a> <a id="887" href="ic20.html#561" class="Function Operator">nf+⟦</a> <a id="892" href="ic20.html#772" class="Function">nf</a> <a id="895" href="ic20.html#857" class="Bound">e</a> <a id="897" href="ic20.html#561" class="Function Operator">⟧</a> <a id="899" href="ic20.html#869" class="Bound">γ</a> <a id="901" href="Basics-v7.html#338" class="Datatype Operator">≡</a> <a id="903" href="ic20.html#265" class="Function Operator">⟦</a> <a id="905" href="ic20.html#857" class="Bound">e</a> <a id="907" href="ic20.html#265" class="Function Operator">⟧</a> <a id="909" href="ic20.html#869" class="Bound">γ</a>


<a id="solve_[_≛_]"></a><a id="913" href="ic20.html#913" class="Function Operator">solve_[_≛_]</a> <a id="925" class="Symbol">:</a> <a id="927" class="Symbol">∀</a> <a id="929" class="Symbol">{</a><a id="930" href="ic20.html#930" class="Bound">N</a><a id="931" class="Symbol">}</a> <a id="933" class="Symbol">(</a><a id="934" href="ic20.html#934" class="Bound">γ</a> <a id="936" class="Symbol">:</a> <a id="938" href="Basics-v7.html#26942" class="Datatype">vec[</a> <a id="943" href="ic20.html#930" class="Bound">N</a> <a id="945" href="Basics-v7.html#26942" class="Datatype">]</a> <a id="947" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="948" class="Symbol">)</a> <a id="950" class="Symbol">(</a><a id="951" href="ic20.html#951" class="Bound">e₁</a> <a id="954" href="ic20.html#954" class="Bound">e₂</a> <a id="957" class="Symbol">:</a> <a id="959" href="ic20.html#48" class="Datatype">exp</a> <a id="963" href="ic20.html#930" class="Bound">N</a><a id="964" class="Symbol">)</a> <a id="966" class="Symbol">{{</a><a id="968" href="ic20.html#968" class="Bound">_</a> <a id="970" class="Symbol">:</a> <a id="972" href="ic20.html#772" class="Function">nf</a> <a id="975" href="ic20.html#951" class="Bound">e₁</a> <a id="978" href="Basics-v7.html#338" class="Datatype Operator">≡</a> <a id="980" href="ic20.html#772" class="Function">nf</a> <a id="983" href="ic20.html#954" class="Bound">e₂</a><a id="985" class="Symbol">}}</a> <a id="988" class="Symbol">→</a> <a id="990" href="ic20.html#265" class="Function Operator">⟦</a> <a id="992" href="ic20.html#951" class="Bound">e₁</a> <a id="995" href="ic20.html#265" class="Function Operator">⟧</a> <a id="997" href="ic20.html#934" class="Bound">γ</a> <a id="999" href="Basics-v7.html#338" class="Datatype Operator">≡</a> <a id="1001" href="ic20.html#265" class="Function Operator">⟦</a> <a id="1003" href="ic20.html#954" class="Bound">e₂</a> <a id="1006" href="ic20.html#265" class="Function Operator">⟧</a> <a id="1008" href="ic20.html#934" class="Bound">γ</a>
<a id="1010" href="ic20.html#913" class="Function Operator">solve</a> <a id="1016" href="ic20.html#1016" class="Bound">γ</a> <a id="1018" href="ic20.html#913" class="Function Operator">[</a> <a id="1020" href="ic20.html#1020" class="Bound">e₁</a> <a id="1023" href="ic20.html#913" class="Function Operator">≛</a> <a id="1025" href="ic20.html#1025" class="Bound">e₂</a> <a id="1028" href="ic20.html#913" class="Function Operator">]</a> <a id="1030" class="Symbol">{{</a><a id="1032" href="ic20.html#1032" class="Bound">ε</a><a id="1033" class="Symbol">}}</a> <a id="1036" class="Symbol">=</a> <a id="1038" class="Symbol">{!!}</a>

<a id="1044" class="Comment">-- a nontrivial arithmetic equality that is easily discharged by solve</a>
<a id="1115" href="ic20.html#1115" class="Function">_</a> <a id="1117" class="Symbol">:</a> <a id="1119" class="Symbol">∀</a> <a id="1121" class="Symbol">(</a><a id="1122" href="ic20.html#1122" class="Bound">x</a> <a id="1124" href="ic20.html#1124" class="Bound">y</a> <a id="1126" href="ic20.html#1126" class="Bound">z</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="Basics-v7.html#15798" class="Datatype">ℕ</a><a id="1131" class="Symbol">)</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="ic20.html#1122" class="Bound">x</a> <a id="1137" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1139" class="Symbol">(</a><a id="1140" href="ic20.html#1122" class="Bound">x</a> <a id="1142" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1144" href="ic20.html#1122" class="Bound">x</a> <a id="1146" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1148" href="ic20.html#1124" class="Bound">y</a> <a id="1150" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1152" href="ic20.html#1126" class="Bound">z</a><a id="1153" class="Symbol">)</a> <a id="1155" href="Basics-v7.html#338" class="Datatype Operator">≡</a> <a id="1157" class="Symbol">(</a><a id="1158" href="ic20.html#1124" class="Bound">y</a> <a id="1160" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1162" href="ic20.html#1122" class="Bound">x</a> <a id="1164" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1166" href="ic20.html#1126" class="Bound">z</a> <a id="1168" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1170" class="Number">1</a> <a id="1172" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1174" href="ic20.html#1122" class="Bound">x</a> <a id="1176" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1178" href="ic20.html#1122" class="Bound">x</a> <a id="1180" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1182" class="Number">2</a> <a id="1184" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1186" href="ic20.html#1122" class="Bound">x</a> <a id="1188" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1190" class="Number">0</a><a id="1191" class="Symbol">)</a> <a id="1193" href="Basics-v7.html#3144" class="Field Operator">*</a> <a id="1195" class="Number">1</a> <a id="1197" href="Basics-v7.html#2460" class="Field Operator">+</a> <a id="1199" class="Number">0</a>
<a id="1201" class="Symbol">_</a> <a id="1203" class="Symbol">=</a> <a id="1205" class="Symbol">λ</a> <a id="1207" href="ic20.html#1207" class="Bound">x</a> <a id="1209" href="ic20.html#1209" class="Bound">y</a> <a id="1211" href="ic20.html#1211" class="Bound">z</a> <a id="1213" class="Symbol">→</a> <a id="1215" class="Symbol">{!!}</a>
</pre></body></html>