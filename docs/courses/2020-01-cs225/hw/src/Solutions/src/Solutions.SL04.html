<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Solutions.SL04</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Testing</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Lex</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Lang.L3</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L3</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">----------</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- [X1] --</span><span>
</span><a name="line-52"></a><span class="hs-comment">----------</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- Here is a well-formedness checker for L3.</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-identifier">wf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-57"></a><a name="wf"><a href="Solutions.SL04.html#wf"><span class="hs-identifier">wf</span></a></a><span> </span><a name="local-6989586621679026398"><a href="#local-6989586621679026398"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621679026399"><a href="#local-6989586621679026399"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679026399"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a name="local-6989586621679026400"><a href="#local-6989586621679026400"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><a name="local-6989586621679026401"><a href="#local-6989586621679026401"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679026402"><a href="#local-6989586621679026402"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679026401"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679026402"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><a name="local-6989586621679030271"><a href="#local-6989586621679030271"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030272"><a href="#local-6989586621679030272"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030271"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030272"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a name="local-6989586621679030273"><a href="#local-6989586621679030273"><span class="hs-identifier">_b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><a name="local-6989586621679030274"><a href="#local-6989586621679030274"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030275"><a href="#local-6989586621679030275"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679030276"><a href="#local-6989586621679030276"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030274"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030275"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030276"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a name="local-6989586621679030277"><a href="#local-6989586621679030277"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.member</span><span> </span><a href="#local-6989586621679030277"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span>
</span><a name="line-64"></a><span>  </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a name="local-6989586621679030278"><a href="#local-6989586621679030278"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679030279"><a href="#local-6989586621679030279"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030280"><a href="#local-6989586621679030280"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621679030279"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.insert</span><span> </span><a href="#local-6989586621679030278"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030280"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-identifier">testX1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-67"></a><a name="testX1"><a href="Solutions.SL04.html#testX1"><span class="hs-identifier">testX1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1&quot;</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;wf&quot;</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL04.html#wf"><span class="hs-identifier hs-var">wf</span></a><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/x1&quot;</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pSet</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">pBool</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">----------</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- [X2] -- </span><span>
</span><a name="line-77"></a><span class="hs-comment">----------</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- Here is a call-by-value interpreter for L3 that uses environments.</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">interpEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L3.Env</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Answer</span><span>
</span><a name="line-82"></a><a name="interpEnv"><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier">interpEnv</span></a></a><span> </span><a name="local-6989586621679030297"><a href="#local-6989586621679030297"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679030298"><a href="#local-6989586621679030298"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679030298"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a name="local-6989586621679030299"><a href="#local-6989586621679030299"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a href="#local-6989586621679030299"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><a name="local-6989586621679030300"><a href="#local-6989586621679030300"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030301"><a href="#local-6989586621679030301"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030300"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030301"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679030302"><a href="#local-6989586621679030302"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679030303"><a href="#local-6989586621679030303"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030302"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679030303"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><a name="local-6989586621679030414"><a href="#local-6989586621679030414"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030415"><a href="#local-6989586621679030415"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030414"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030415"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679030416"><a href="#local-6989586621679030416"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679030417"><a href="#local-6989586621679030417"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030416"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679030417"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a name="local-6989586621679030418"><a href="#local-6989586621679030418"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.BoolV</span><span> </span><a href="#local-6989586621679030418"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><a name="local-6989586621679030419"><a href="#local-6989586621679030419"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679030420"><a href="#local-6989586621679030420"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679030421"><a href="#local-6989586621679030421"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030419"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.BoolV</span><span> </span><a name="local-6989586621679030422"><a href="#local-6989586621679030422"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-93"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679030422"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-94"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030420"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-95"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679030421"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a name="local-6989586621679030423"><a href="#local-6989586621679030423"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679030423"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679031407"><a href="#local-6989586621679031407"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><a href="#local-6989586621679031407"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a name="local-6989586621679031408"><a href="#local-6989586621679031408"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031409"><a href="#local-6989586621679031409"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031410"><a href="#local-6989586621679031410"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679031409"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><a name="local-6989586621679031411"><a href="#local-6989586621679031411"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679031408"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031411"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679030297"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031410"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-identifier">testX2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-105"></a><a name="testX2"><a href="Solutions.SL04.html#testX2"><span class="hs-identifier">testX2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X2&quot;</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpEnv&quot;</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL04.html#interpEnv"><span class="hs-identifier hs-var">interpEnv</span></a><span>
</span><a name="line-109"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/x2&quot;</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-identifier hs-var">L3.pEnv</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L3.pAnswer</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">----------</span><span>
</span><a name="line-114"></a><span class="hs-comment">-- [X3] --</span><span>
</span><a name="line-115"></a><span class="hs-comment">----------</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- Convert a value to an expression.</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">exprFromValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L3.Value</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span>
</span><a name="line-120"></a><a name="exprFromValue"><a href="Solutions.SL04.html#exprFromValue"><span class="hs-identifier">exprFromValue</span></a></a><span> </span><a name="local-6989586621679031412"><a href="#local-6989586621679031412"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031412"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679031413"><a href="#local-6989586621679031413"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a href="#local-6989586621679031413"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-122"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolV</span><span> </span><a name="local-6989586621679031414"><a href="#local-6989586621679031414"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a href="#local-6989586621679031414"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">testX3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-125"></a><a name="testX3"><a href="Solutions.SL04.html#testX3"><span class="hs-identifier">testX3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X3&quot;</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;exprFromValue&quot;</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#exprFromValue"><span class="hs-identifier hs-var">exprFromValue</span></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/x3&quot;</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-identifier hs-var">L3.pValue</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- [E1]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-139"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- Write a free variable analysis for L3.</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">fv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-144"></a><a name="fv"><a href="Solutions.SL04.html#fv"><span class="hs-identifier">fv</span></a></a><span> </span><a name="local-6989586621679031415"><a href="#local-6989586621679031415"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031415"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a name="local-6989586621679031416"><a href="#local-6989586621679031416"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><a name="local-6989586621679031417"><a href="#local-6989586621679031417"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031418"><a href="#local-6989586621679031418"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031417"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031418"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><a name="local-6989586621679031419"><a href="#local-6989586621679031419"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031420"><a href="#local-6989586621679031420"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031419"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031420"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a name="local-6989586621679031421"><a href="#local-6989586621679031421"><span class="hs-identifier">_b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><a name="local-6989586621679031422"><a href="#local-6989586621679031422"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031423"><a href="#local-6989586621679031423"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679031424"><a href="#local-6989586621679031424"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031422"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031423"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031424"><span class="hs-identifier hs-var">e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a name="local-6989586621679031425"><a href="#local-6989586621679031425"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679031425"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a name="local-6989586621679031426"><a href="#local-6989586621679031426"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031427"><a href="#local-6989586621679031427"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031428"><a href="#local-6989586621679031428"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031427"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679031426"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679031428"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-identifier">testE1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-154"></a><a name="testE1"><a href="Solutions.SL04.html#testE1"><span class="hs-identifier">testE1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fv&quot;</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#fv"><span class="hs-identifier hs-var">fv</span></a><span>
</span><a name="line-158"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/e1&quot;</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pSet</span><span> </span><span class="hs-identifier hs-var">pVar</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- [E2]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-164"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- Write a substitution function for L3.</span><span>
</span><a name="line-167"></a><span class="hs-comment">--</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- `subst x e1 e2` should return an expression just like e2, but with all</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- occurrences of x replaced with the term e1.</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- Assume that the expression being substituted is closed.</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span>
</span><a name="line-174"></a><a name="subst"><a href="Solutions.SL04.html#subst"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-6989586621679031429"><a href="#local-6989586621679031429"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031430"><a href="#local-6989586621679031430"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031431"><a href="#local-6989586621679031431"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031431"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a name="local-6989586621679031432"><a href="#local-6989586621679031432"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a href="#local-6989586621679031432"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-176"></a><span>  </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><a name="local-6989586621679031433"><a href="#local-6989586621679031433"><span class="hs-identifier">e21</span></a></a><span> </span><a name="local-6989586621679031434"><a href="#local-6989586621679031434"><span class="hs-identifier">e22</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031433"><span class="hs-identifier hs-var">e21</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031434"><span class="hs-identifier hs-var">e22</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><a name="local-6989586621679031435"><a href="#local-6989586621679031435"><span class="hs-identifier">e21</span></a></a><span> </span><a name="local-6989586621679031436"><a href="#local-6989586621679031436"><span class="hs-identifier">e22</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031435"><span class="hs-identifier hs-var">e21</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031436"><span class="hs-identifier hs-var">e22</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a name="local-6989586621679031437"><a href="#local-6989586621679031437"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a href="#local-6989586621679031437"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-179"></a><span>  </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><a name="local-6989586621679031438"><a href="#local-6989586621679031438"><span class="hs-identifier">e21</span></a></a><span> </span><a name="local-6989586621679031439"><a href="#local-6989586621679031439"><span class="hs-identifier">e22</span></a></a><span> </span><a name="local-6989586621679031440"><a href="#local-6989586621679031440"><span class="hs-identifier">e23</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031438"><span class="hs-identifier hs-var">e21</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031439"><span class="hs-identifier hs-var">e22</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031440"><span class="hs-identifier hs-var">e23</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a name="local-6989586621679031441"><a href="#local-6989586621679031441"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679031441"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-182"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-183"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a href="#local-6989586621679031441"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-184"></a><span>  </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a name="local-6989586621679031442"><a href="#local-6989586621679031442"><span class="hs-identifier">x'</span></a></a><span> </span><a name="local-6989586621679031443"><a href="#local-6989586621679031443"><span class="hs-identifier">e21</span></a></a><span> </span><a name="local-6989586621679031444"><a href="#local-6989586621679031444"><span class="hs-identifier">e22</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679031442"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-186"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a href="#local-6989586621679031442"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031443"><span class="hs-identifier hs-var">e21</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031444"><span class="hs-identifier hs-var">e22</span></a><span>
</span><a name="line-187"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a href="#local-6989586621679031442"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031443"><span class="hs-identifier hs-var">e21</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031429"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679031430"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679031444"><span class="hs-identifier hs-var">e22</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-identifier">testE2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-190"></a><a name="testE2"><a href="Solutions.SL04.html#testE2"><span class="hs-identifier">testE2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;subst&quot;</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/e2&quot;</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pPair</span><span> </span><span class="hs-identifier hs-var">pVar</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- [E3]: &#9733;&#9733;&#9733; --</span><span>
</span><a name="line-200"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- Write a call-by-value interpreter for L3 that uses `subst` (your solution to</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- E2). You should also use `exprFromValue` (the example X3).</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-identifier">interpSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">L3.Expr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L3.Answer</span><span>
</span><a name="line-206"></a><a name="interpSubst"><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier">interpSubst</span></a></a><span> </span><a name="local-6989586621679031445"><a href="#local-6989586621679031445"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031445"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-identifier hs-var">L3.IntE</span><span> </span><a name="local-6989586621679031446"><a href="#local-6989586621679031446"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a href="#local-6989586621679031446"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>  </span><span class="hs-identifier hs-var">L3.PlusE</span><span> </span><a name="local-6989586621679031447"><a href="#local-6989586621679031447"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031448"><a href="#local-6989586621679031448"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031447"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031448"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679031449"><a href="#local-6989586621679031449"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679031450"><a href="#local-6989586621679031450"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031449"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679031450"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-identifier hs-var">L3.TimesE</span><span> </span><a name="local-6989586621679031451"><a href="#local-6989586621679031451"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031452"><a href="#local-6989586621679031452"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031451"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031452"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679031453"><a href="#local-6989586621679031453"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><a name="local-6989586621679031454"><a href="#local-6989586621679031454"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.IntV</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031453"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679031454"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-identifier hs-var">L3.BoolE</span><span> </span><a name="local-6989586621679031455"><a href="#local-6989586621679031455"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.BoolV</span><span> </span><a href="#local-6989586621679031455"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-identifier hs-var">L3.IfE</span><span> </span><a name="local-6989586621679031456"><a href="#local-6989586621679031456"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031457"><a href="#local-6989586621679031457"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679031458"><a href="#local-6989586621679031458"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031456"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L3.BoolV</span><span> </span><a name="local-6989586621679031459"><a href="#local-6989586621679031459"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-217"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679031459"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-218"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031457"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-219"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031458"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-identifier hs-var">L3.VarE</span><span> </span><a name="local-6989586621679031460"><a href="#local-6989586621679031460"><span class="hs-identifier">_x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-identifier hs-var">L3.LetE</span><span> </span><a name="local-6989586621679031461"><a href="#local-6989586621679031461"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031462"><a href="#local-6989586621679031462"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679031463"><a href="#local-6989586621679031463"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><a href="#local-6989586621679031462"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-223"></a><span>    </span><span class="hs-identifier hs-var">L3.ValueA</span><span> </span><a name="local-6989586621679031464"><a href="#local-6989586621679031464"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679031461"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Solutions.SL04.html#exprFromValue"><span class="hs-identifier hs-var">exprFromValue</span></a><span> </span><a href="#local-6989586621679031464"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031463"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L3.BadA</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">testE3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Test</span><span>
</span><a name="line-227"></a><a name="testE3"><a href="Solutions.SL04.html#testE3"><span class="hs-identifier">testE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TestDir</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpSubst&quot;</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#interpSubst"><span class="hs-identifier hs-var">interpSubst</span></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw04/e3&quot;</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseTest</span><span> </span><span class="hs-identifier hs-var">L3.pExpr</span><span> </span><span class="hs-identifier hs-var">L3.pAnswer</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-236"></a><a name="main"><a href="Solutions.SL04.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runTests</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-comment">-- examples</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="Solutions.SL04.html#testX1"><span class="hs-identifier hs-var">testX1</span></a><span>
</span><a name="line-239"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#testX2"><span class="hs-identifier hs-var">testX2</span></a><span>
</span><a name="line-240"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#testX3"><span class="hs-identifier hs-var">testX3</span></a><span>
</span><a name="line-241"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#testE1"><span class="hs-identifier hs-var">testE1</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#testE2"><span class="hs-identifier hs-var">testE2</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Solutions.SL04.html#testE3"><span class="hs-identifier hs-var">testE3</span></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a></pre></body></html>