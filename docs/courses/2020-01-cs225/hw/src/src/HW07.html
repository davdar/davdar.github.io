<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HW07</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Testing.html"><span class="hs-identifier">Util.Testing</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Lex.html"><span class="hs-identifier">Util.Lex</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L6.html"><span class="hs-identifier">Lang.L6</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L6</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- REFERECE --</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- Here is a copy of of Lang.L6.Data for your reference:</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">{-
-----------------
-- EXPRESSIONS --
-----------------

data Expr = 
    IntE Integer
  | PlusE Expr Expr 
  | TimesE Expr Expr
  | BoolE Bool
  | IfE Expr Expr Expr
  | VarE String
  | LetE String Expr Expr
  | FunE String Expr
  | AppE Expr Expr
  -- NEW
  | BoxE Expr
  | UnboxE Expr
  | AssignE Expr Expr
  deriving (Eq,Ord,Show)

---------------
-- SEMANTICS --
---------------

data Value = 
    IntV Integer
  | BoolV Bool
  | CloV String Expr Env
  -- NEW
  | LocV Integer
  deriving (Eq,Ord,Show)

-- NEW
type Answer = Maybe (Store, Value)

type Env = Map String Value

-- NEW
type Store = Map Integer Value
-}</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">----------</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- [X1] --</span><span>
</span><a name="line-101"></a><span class="hs-comment">----------</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- Define a function that counts up from [1..n] for some n</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-identifier">countDown</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span>
</span><a name="line-106"></a><a name="countDown"><a href="HW07.html#countDown"><span class="hs-identifier">countDown</span></a></a><span> </span><a name="local-6989586621679101336"><a href="#local-6989586621679101336"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679101336"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-108"></a><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span>     </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679101336"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="HW07.html#countDown"><span class="hs-identifier hs-var">countDown</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101336"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- Define a function that counts down from [n..1] for some n</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">countUp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span>
</span><a name="line-114"></a><a name="countUp"><a href="HW07.html#countUp"><span class="hs-identifier">countUp</span></a></a><span> </span><a name="local-6989586621679101337"><a href="#local-6989586621679101337"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679101338"><a href="#local-6989586621679101338"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679101337"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-116"></a><span>     </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679101338"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-117"></a><span>     </span><span class="hs-keyword">else</span><span> </span><a href="HW07.html#countUp"><span class="hs-identifier hs-var">countUp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101337"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101337"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679101338"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">testX1A</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-120"></a><a name="testX1A"><a href="HW07.html#testX1A"><span class="hs-identifier">testX1A</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#Test1"><span class="hs-identifier hs-var">Test1</span></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1A&quot;</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;countDown&quot;</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#countDown"><span class="hs-identifier hs-var">countDown</span></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">5</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">testX1B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-132"></a><a name="testX1B"><a href="HW07.html#testX1B"><span class="hs-identifier">testX1B</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#Test1"><span class="hs-identifier hs-var">Test1</span></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1B&quot;</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;countUp&quot;</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679101339"><a href="#local-6989586621679101339"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW07.html#countUp"><span class="hs-identifier hs-var">countUp</span></a><span> </span><a href="#local-6989586621679101339"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">----------</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- [X2] -- </span><span>
</span><a name="line-146"></a><span class="hs-comment">----------</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- Define a function that deletes the three smallest keys from a map, and</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- returns the sum of values mapped to those keys, along with the modified map.</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-identifier">stateManipulation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><a name="stateManipulation"><a href="HW07.html#stateManipulation"><span class="hs-identifier">stateManipulation</span></a></a><span> </span><a name="local-6989586621679101340"><a href="#local-6989586621679101340"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.minView</span><span> </span><a href="#local-6989586621679101340"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679101341"><a href="#local-6989586621679101341"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101342"><a href="#local-6989586621679101342"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.minView</span><span> </span><a href="#local-6989586621679101342"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-155"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679101343"><a href="#local-6989586621679101343"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101344"><a href="#local-6989586621679101344"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.minView</span><span> </span><a href="#local-6989586621679101344"><span class="hs-identifier hs-var">sto''</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-156"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679101345"><a href="#local-6989586621679101345"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101346"><a href="#local-6989586621679101346"><span class="hs-identifier">sto'''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101341"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679101343"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679101345"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101346"><span class="hs-identifier hs-var">sto'''</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-158"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-identifier">testX2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-162"></a><a name="testX2"><a href="HW07.html#testX2"><span class="hs-identifier">testX2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#Test1"><span class="hs-identifier hs-var">Test1</span></a><span>
</span><a name="line-163"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X2&quot;</span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stateManipulation&quot;</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#stateManipulation"><span class="hs-identifier hs-var">stateManipulation</span></a><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;W&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;A&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;L&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;E&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">5</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;R&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">6</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-167"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;W&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;R&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">6</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;Walter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Camilla&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;David&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Willow&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;Willow&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">----------</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- [X3] --</span><span>
</span><a name="line-175"></a><span class="hs-comment">----------</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- Define a function which computes the free variables of an expression in our</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- new language which contains features for mutable state and first class</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- references.</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">freeVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L6.Data.html#Expr"><span class="hs-identifier hs-type">L6.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-182"></a><a name="freeVars"><a href="HW07.html#freeVars"><span class="hs-identifier">freeVars</span></a></a><span> </span><a name="local-6989586621679101347"><a href="#local-6989586621679101347"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679101347"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-183"></a><span>  </span><a href="Lang.L6.Data.html#IntE"><span class="hs-identifier hs-var">L6.IntE</span></a><span> </span><a name="local-6989586621679101348"><a href="#local-6989586621679101348"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-184"></a><span>  </span><a href="Lang.L6.Data.html#PlusE"><span class="hs-identifier hs-var">L6.PlusE</span></a><span> </span><a name="local-6989586621679101349"><a href="#local-6989586621679101349"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101350"><a href="#local-6989586621679101350"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101349"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101350"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>  </span><a href="Lang.L6.Data.html#TimesE"><span class="hs-identifier hs-var">L6.TimesE</span></a><span> </span><a name="local-6989586621679101351"><a href="#local-6989586621679101351"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101352"><a href="#local-6989586621679101352"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101351"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101352"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>  </span><a href="Lang.L6.Data.html#BoolE"><span class="hs-identifier hs-var">L6.BoolE</span></a><span> </span><a name="local-6989586621679101353"><a href="#local-6989586621679101353"><span class="hs-identifier">_b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-187"></a><span>  </span><a href="Lang.L6.Data.html#IfE"><span class="hs-identifier hs-var">L6.IfE</span></a><span> </span><a name="local-6989586621679101354"><a href="#local-6989586621679101354"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101355"><a href="#local-6989586621679101355"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679101356"><a href="#local-6989586621679101356"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101354"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101355"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101356"><span class="hs-identifier hs-var">e3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>  </span><a href="Lang.L6.Data.html#VarE"><span class="hs-identifier hs-var">L6.VarE</span></a><span> </span><a name="local-6989586621679101357"><a href="#local-6989586621679101357"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679101357"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-189"></a><span>  </span><a href="Lang.L6.Data.html#LetE"><span class="hs-identifier hs-var">L6.LetE</span></a><span> </span><a name="local-6989586621679101358"><a href="#local-6989586621679101358"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679101359"><a href="#local-6989586621679101359"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101360"><a href="#local-6989586621679101360"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101359"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679101358"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101360"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>  </span><a href="Lang.L6.Data.html#FunE"><span class="hs-identifier hs-var">L6.FunE</span></a><span> </span><a name="local-6989586621679101361"><a href="#local-6989586621679101361"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679101362"><a href="#local-6989586621679101362"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679101361"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101362"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>  </span><a href="Lang.L6.Data.html#AppE"><span class="hs-identifier hs-var">L6.AppE</span></a><span> </span><a name="local-6989586621679101363"><a href="#local-6989586621679101363"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101364"><a href="#local-6989586621679101364"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101363"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101364"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>  </span><a href="Lang.L6.Data.html#BoxE"><span class="hs-identifier hs-var">L6.BoxE</span></a><span> </span><a name="local-6989586621679101365"><a href="#local-6989586621679101365"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101365"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-193"></a><span>  </span><a href="Lang.L6.Data.html#UnboxE"><span class="hs-identifier hs-var">L6.UnboxE</span></a><span> </span><a name="local-6989586621679101366"><a href="#local-6989586621679101366"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101366"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-194"></a><span>  </span><a href="Lang.L6.Data.html#AssignE"><span class="hs-identifier hs-var">L6.AssignE</span></a><span> </span><a name="local-6989586621679101367"><a href="#local-6989586621679101367"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101368"><a href="#local-6989586621679101368"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101367"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679101368"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">testX3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-197"></a><a name="testX3"><a href="HW07.html#testX3"><span class="hs-identifier">testX3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-198"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X3&quot;</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;freeVars&quot;</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span>
</span><a name="line-201"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw07/x3&quot;</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L6.Util.html#pExpr"><span class="hs-identifier hs-var">L6.pExpr</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pSet"><span class="hs-identifier hs-var">pSet</span></a><span> </span><a href="Util.Lex.html#pVar"><span class="hs-identifier hs-var">pVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- [E1]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-211"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- Implement a function which takes a list of integers as input and returns the</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- smallest nonnegative integer which is larger than every integer in the list,</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- or 0 if there are no elements in the list. </span><span>
</span><a name="line-216"></a><span class="hs-comment">--</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- A spec for the function is as follows:</span><span>
</span><a name="line-218"></a><span class="hs-comment">--</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- fresh-integer &#8712; list(&#8484;) &#8594; &#8484;</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- fresh-integer [i&#8321;,&#8230;,i&#8345;] &#8796; i</span><span>
</span><a name="line-221"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-222"></a><span class="hs-comment">--     i = MAX [0,n&#8321;+1,&#8230;,n&#8345;+1]</span><span>
</span><a name="line-223"></a><span class="hs-comment">--</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- HINT: implement this function by recursion on the list of integers</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">freshInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-227"></a><a name="freshInteger"><a href="HW07.html#freshInteger"><span class="hs-identifier">freshInteger</span></a></a><span> </span><a name="local-6989586621679101369"><a href="#local-6989586621679101369"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-identifier">testE1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-230"></a><a name="testE1"><a href="HW07.html#testE1"><span class="hs-identifier">testE1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#Test1"><span class="hs-identifier hs-var">Test1</span></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;freshInteger&quot;</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#freshInteger"><span class="hs-identifier hs-var">freshInteger</span></a><span>
</span><a name="line-234"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="hs-number">12</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- [E2]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-243"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- Implement a function which takes a store and returns a fresh location which</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- is not currently used in the domain of the store.</span><span>
</span><a name="line-247"></a><span class="hs-comment">--</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- A spec for the function is as follows:</span><span>
</span><a name="line-249"></a><span class="hs-comment">--</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- fresh-location &#8712; store &#8594; loc</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- fresh-location(&#963;) &#8796; &#8467;</span><span>
</span><a name="line-252"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-253"></a><span class="hs-comment">--     &#8467; &#8713; dom(&#963;)</span><span>
</span><a name="line-254"></a><span class="hs-comment">--</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- HINTS: </span><span>
</span><a name="line-256"></a><span class="hs-comment">-- - use `Map.keys :: Map k v -&gt; [k]`</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- - use `freshInteger` (E1)</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">freshLocation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L6.Data.html#Store"><span class="hs-identifier hs-type">L6.Store</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-260"></a><a name="freshLocation"><a href="HW07.html#freshLocation"><span class="hs-identifier">freshLocation</span></a></a><span> </span><a name="local-6989586621679101384"><a href="#local-6989586621679101384"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-identifier">testE2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-263"></a><a name="testE2"><a href="HW07.html#testE2"><span class="hs-identifier">testE2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#Test1"><span class="hs-identifier hs-var">Test1</span></a><span>
</span><a name="line-264"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;freshLocation&quot;</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#freshLocation"><span class="hs-identifier hs-var">freshLocation</span></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">100</span><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">200</span><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">300</span><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">301</span><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>   </span><span class="hs-special">]</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- [E3]: &#9733;&#9733;&#9733; --</span><span>
</span><a name="line-275"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">-- Implement an interpreter for L6, the language with state mutation and first</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- class references.</span><span>
</span><a name="line-279"></a><span class="hs-comment">--</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- Where the following spec is not defined, your implementation should return</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- `Nothing`.</span><span>
</span><a name="line-282"></a><span class="hs-comment">--</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- A spec for the function is as follows:</span><span>
</span><a name="line-284"></a><span class="hs-comment">--</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- &#10214;_&#10215; &#8712; expr &#8594; (env &#215; store &#8640; value &#215; store)</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- &#10214;i&#10215;(&#947;,&#963;) &#8796; (i,&#963;)</span><span>
</span><a name="line-287"></a><span class="hs-comment">-- &#10214;e&#8321; + e&#8322;&#10215;(&#947;,&#963;) &#8796; (i&#8321; + i&#8322;,&#963;&#8243;)</span><span>
</span><a name="line-288"></a><span class="hs-comment">--   where (i&#8321;,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-289"></a><span class="hs-comment">--         (i&#8322;,&#963;&#8243;) = &#10214;e&#8321;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- &#10214;e&#8321; * e&#8322;&#10215;(&#947;,&#963;) &#8796; (i&#8321; * i&#8322;,&#963;&#8243;)</span><span>
</span><a name="line-291"></a><span class="hs-comment">--   where (i&#8321;,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-292"></a><span class="hs-comment">--         (i&#8322;,&#963;&#8243;) = &#10214;e&#8321;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- &#10214;b&#10215;(&#947;,&#963;) &#8796; (b,&#963;)</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215;(&#947;,&#963;) &#8796; &#10214;e&#8322;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-295"></a><span class="hs-comment">--   when (true,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- &#10214;if e&#8321; then e&#8322; else e&#8323;&#10215;(&#947;,&#963;) &#8796; &#10214;e&#8323;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-297"></a><span class="hs-comment">--   when (false,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- &#10214;x&#10215;(&#947;,&#963;) &#8796; (v,&#963;)</span><span>
</span><a name="line-299"></a><span class="hs-comment">--   where v = &#947;(x)</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- &#10214;let x = e&#8321; in e&#8322;&#10215;(&#947;,&#963;) &#8796; &#10214;e&#8322;&#10215;(&#947;&#8242;,&#963;&#8242;)</span><span>
</span><a name="line-301"></a><span class="hs-comment">--   where (v,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-302"></a><span class="hs-comment">--         &#947;&#8242;     = &#947;[x&#8614;v]</span><span>
</span><a name="line-303"></a><span class="hs-comment">-- &#10214;fun x &#8658; e&#10215;(&#947;,&#963;) &#8796; (&#10216;fun x &#8658; e , &#947; &#10217;, &#963;)</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- &#10214;e&#8321; e&#8322;&#10215;(&#947;,&#963;) &#8796; &#10214;e&#10215;(&#947;&#8243;,&#963;&#8243;)</span><span>
</span><a name="line-305"></a><span class="hs-comment">--   where (&#10216; fun x &#8658; e , &#947;&#8242; &#10217;,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-306"></a><span class="hs-comment">--         (v,&#963;&#8243;)                  = &#10214;e&#8322;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-307"></a><span class="hs-comment">--         &#947;&#8243;                      = &#947;&#8242;[x&#8614;v]</span><span>
</span><a name="line-308"></a><span class="hs-comment">-- &#10214;box e&#10215;(&#947;,&#963;) &#8796; (&#8467;, &#963;&#8243;)</span><span>
</span><a name="line-309"></a><span class="hs-comment">--   where (v,&#963;&#8242;) = &#10214;e&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-310"></a><span class="hs-comment">--         &#963;&#8243;     = &#963;&#8242;[&#8467;&#8614;v]</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- &#10214;!e&#10215;(&#947;,&#963;) &#8796; (v,&#963;&#8242;)</span><span>
</span><a name="line-312"></a><span class="hs-comment">--   where (&#8467;,&#963;&#8242;) = &#10214;e&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-313"></a><span class="hs-comment">--         v      = &#963;&#8242;(&#8467;)</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- &#10214;e&#8321; &#8592; e&#8322;&#10215;(&#947;,&#963;) &#8796; (v,&#963;&#8244;)</span><span>
</span><a name="line-315"></a><span class="hs-comment">--   where (&#8467;,&#963;&#8242;) = &#10214;e&#8321;&#10215;(&#947;,&#963;)</span><span>
</span><a name="line-316"></a><span class="hs-comment">--         (v,&#963;&#8243;) = &#10214;e&#8322;&#10215;(&#947;,&#963;&#8242;)</span><span>
</span><a name="line-317"></a><span class="hs-comment">--         &#963;&#8244;     = &#963;&#8243;[&#8467;&#8614;v]</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-identifier">interp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L6.Data.html#Expr"><span class="hs-identifier hs-type">L6.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L6.Data.html#Env"><span class="hs-identifier hs-type">L6.Env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L6.Data.html#Store"><span class="hs-identifier hs-type">L6.Store</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#Value"><span class="hs-identifier hs-type">L6.Value</span></a><span class="hs-special">,</span><span> </span><a href="Lang.L6.Data.html#Store"><span class="hs-identifier hs-type">L6.Store</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><a name="interp"><a href="HW07.html#interp"><span class="hs-identifier">interp</span></a></a><span> </span><a name="local-6989586621679101385"><a href="#local-6989586621679101385"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679101386"><a href="#local-6989586621679101386"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679101387"><a href="#local-6989586621679101387"><span class="hs-identifier">sto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679101385"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-321"></a><span>  </span><a href="Lang.L6.Data.html#IntE"><span class="hs-identifier hs-var">L6.IntE</span></a><span> </span><a name="local-6989586621679101388"><a href="#local-6989586621679101388"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><a href="#local-6989586621679101388"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>  </span><a href="Lang.L6.Data.html#PlusE"><span class="hs-identifier hs-var">L6.PlusE</span></a><span> </span><a name="local-6989586621679101389"><a href="#local-6989586621679101389"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101390"><a href="#local-6989586621679101390"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101389"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-323"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><a name="local-6989586621679101391"><a href="#local-6989586621679101391"><span class="hs-identifier">i1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101392"><a href="#local-6989586621679101392"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101390"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101392"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-324"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><a name="local-6989586621679101393"><a href="#local-6989586621679101393"><span class="hs-identifier">i2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101394"><a href="#local-6989586621679101394"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101391"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679101393"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101394"><span class="hs-identifier hs-var">sto''</span></a><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-326"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-327"></a><span>  </span><a href="Lang.L6.Data.html#TimesE"><span class="hs-identifier hs-var">L6.TimesE</span></a><span> </span><a name="local-6989586621679101395"><a href="#local-6989586621679101395"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101396"><a href="#local-6989586621679101396"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101395"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-328"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><a name="local-6989586621679101397"><a href="#local-6989586621679101397"><span class="hs-identifier">i1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101398"><a href="#local-6989586621679101398"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101396"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101398"><span class="hs-identifier hs-var">sto'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-329"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><a name="local-6989586621679101399"><a href="#local-6989586621679101399"><span class="hs-identifier">i2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101400"><a href="#local-6989586621679101400"><span class="hs-identifier">sto''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#IntV"><span class="hs-identifier hs-var">L6.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101397"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679101399"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101400"><span class="hs-identifier hs-var">sto''</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-331"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-332"></a><span>  </span><a href="Lang.L6.Data.html#BoolE"><span class="hs-identifier hs-var">L6.BoolE</span></a><span> </span><a name="local-6989586621679101401"><a href="#local-6989586621679101401"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#BoolV"><span class="hs-identifier hs-var">L6.BoolV</span></a><span> </span><a href="#local-6989586621679101401"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>  </span><a href="Lang.L6.Data.html#IfE"><span class="hs-identifier hs-var">L6.IfE</span></a><span> </span><a name="local-6989586621679101402"><a href="#local-6989586621679101402"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101403"><a href="#local-6989586621679101403"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679101404"><a href="#local-6989586621679101404"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101402"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Lang.L6.Data.html#BoolV"><span class="hs-identifier hs-var">L6.BoolV</span></a><span> </span><a name="local-6989586621679101405"><a href="#local-6989586621679101405"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101406"><a href="#local-6989586621679101406"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-335"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679101405"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-336"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101403"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101406"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-337"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101404"><span class="hs-identifier hs-var">e3</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101406"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-338"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-339"></a><span>  </span><a href="Lang.L6.Data.html#VarE"><span class="hs-identifier hs-var">L6.VarE</span></a><span> </span><a name="local-6989586621679101407"><a href="#local-6989586621679101407"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679101407"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-340"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679101408"><a href="#local-6989586621679101408"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101408"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-342"></a><span>  </span><a href="Lang.L6.Data.html#LetE"><span class="hs-identifier hs-var">L6.LetE</span></a><span> </span><a name="local-6989586621679101409"><a href="#local-6989586621679101409"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679101410"><a href="#local-6989586621679101410"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101411"><a href="#local-6989586621679101411"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101410"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679101387"><span class="hs-identifier hs-var">sto</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-343"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679101412"><a href="#local-6989586621679101412"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101413"><a href="#local-6989586621679101413"><span class="hs-identifier">sto'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101411"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679101409"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679101412"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679101386"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679101413"><span class="hs-identifier hs-var">sto'</span></a><span>
</span><a name="line-344"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-345"></a><span>  </span><a href="Lang.L6.Data.html#FunE"><span class="hs-identifier hs-var">L6.FunE</span></a><span> </span><a name="local-6989586621679101414"><a href="#local-6989586621679101414"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679101415"><a href="#local-6989586621679101415"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-346"></a><span>  </span><a href="Lang.L6.Data.html#AppE"><span class="hs-identifier hs-var">L6.AppE</span></a><span> </span><a name="local-6989586621679101416"><a href="#local-6989586621679101416"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101417"><a href="#local-6989586621679101417"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-347"></a><span>  </span><a href="Lang.L6.Data.html#BoxE"><span class="hs-identifier hs-var">L6.BoxE</span></a><span> </span><a name="local-6989586621679101418"><a href="#local-6989586621679101418"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-348"></a><span>  </span><a href="Lang.L6.Data.html#UnboxE"><span class="hs-identifier hs-var">L6.UnboxE</span></a><span> </span><a name="local-6989586621679101419"><a href="#local-6989586621679101419"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-349"></a><span>  </span><a href="Lang.L6.Data.html#AssignE"><span class="hs-identifier hs-var">L6.AssignE</span></a><span> </span><a name="local-6989586621679101420"><a href="#local-6989586621679101420"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101421"><a href="#local-6989586621679101421"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">testE3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-352"></a><a name="testE3"><a href="HW07.html#testE3"><span class="hs-identifier">testE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-353"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-354"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interp&quot;</span><span>
</span><a name="line-355"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679101422"><a href="#local-6989586621679101422"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HW07.html#interp"><span class="hs-identifier hs-var">interp</span></a><span> </span><a href="#local-6989586621679101422"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw07/e3&quot;</span><span>
</span><a name="line-357"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L6.Util.html#pExpr"><span class="hs-identifier hs-var">L6.pExpr</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pMaybe"><span class="hs-identifier hs-var">pMaybe</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><a href="Lang.L6.Util.html#pValue"><span class="hs-identifier hs-var">L6.pValue</span></a><span> </span><a href="Lang.L6.Util.html#pStore"><span class="hs-identifier hs-var">L6.pStore</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-361"></a><a name="main"><a href="HW07.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#runTests"><span class="hs-identifier hs-var">runTests</span></a><span>
</span><a name="line-362"></a><span>  </span><span class="hs-comment">-- examples</span><span>
</span><a name="line-363"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="HW07.html#testX1A"><span class="hs-identifier hs-var">testX1A</span></a><span>
</span><a name="line-364"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testX1B"><span class="hs-identifier hs-var">testX1B</span></a><span>
</span><a name="line-365"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testX2"><span class="hs-identifier hs-var">testX2</span></a><span>
</span><a name="line-366"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testX3"><span class="hs-identifier hs-var">testX3</span></a><span>
</span><a name="line-367"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-368"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testE1"><span class="hs-identifier hs-var">testE1</span></a><span>
</span><a name="line-369"></a><span> </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testE2"><span class="hs-identifier hs-var">testE2</span></a><span>
</span><a name="line-370"></a><span> </span><span class="hs-special">,</span><span> </span><a href="HW07.html#testE3"><span class="hs-identifier hs-var">testE3</span></a><span>
</span><a name="line-371"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-372"></a></pre></body></html>