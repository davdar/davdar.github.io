<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HW03</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-

Name: 

&lt;put your name here&gt;

Collaboration Statement:

&lt;put your collaboration statement here&gt;

Collaboration on high-level ideas and approach on assignments is
encouraged. Copying someone else's work is not allowed. Copying solutions
from an online source is not allowed. Any collaboration or online
resources, even if used only a small amount, must be declared in your
assignment when you submit it. For example: &#8220;I discussed high-level
strategies for solving problem 2 and 5 with Alex; I found this
stackoverflow post (&lt;link&gt;) helpful while working on problem 3.&#8221; Students
caught copying work are eligible for immediate failure of the course and
disciplinary action by the University. All academic integrity misconduct
will be treated according to UVM's Code of Academic Integrity.

-}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Testing.html"><span class="hs-identifier">Util.Testing</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Util.Lex.html"><span class="hs-identifier">Util.Lex</span></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L1.html"><span class="hs-identifier">Lang.L1</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L1</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L1M.html"><span class="hs-identifier">Lang.L1M</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L1M</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L1MN.html"><span class="hs-identifier">Lang.L1MN</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L1MN</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L2.html"><span class="hs-identifier">Lang.L2</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L2</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Lang.L2C.html"><span class="hs-identifier">Lang.L2C</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L2C</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- SUBMITTING --</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- How to submit:</span><span>
</span><a name="line-44"></a><span class="hs-comment">--</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- Submit a copy of this file only &#8220;HWXX.hs&#8221; (for XX = 01, 02, etc.) to</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- gradescope.</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- EXAMPLES --</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- ======== --</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">----------</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- [X1] --</span><span>
</span><a name="line-54"></a><span class="hs-comment">----------</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- Here is an interpreter for L1:</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">interpL1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L1.Data.html#Expr"><span class="hs-identifier hs-type">L1.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#Answer"><span class="hs-identifier hs-type">L1.Answer</span></a><span>
</span><a name="line-59"></a><a name="interpL1"><a href="HW03.html#interpL1"><span class="hs-identifier">interpL1</span></a></a><span> </span><a name="local-6989586621679145731"><a href="#local-6989586621679145731"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679145731"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-60"></a><span>  </span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><a name="local-6989586621679145732"><a href="#local-6989586621679145732"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><a href="#local-6989586621679145732"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><a href="Lang.L1.Data.html#PlusE"><span class="hs-identifier hs-var">L1.PlusE</span></a><span> </span><a name="local-6989586621679145733"><a href="#local-6989586621679145733"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145734"><a href="#local-6989586621679145734"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW03.html#interpL1"><span class="hs-identifier hs-var">interpL1</span></a><span> </span><a href="#local-6989586621679145733"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW03.html#interpL1"><span class="hs-identifier hs-var">interpL1</span></a><span> </span><a href="#local-6989586621679145734"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><a name="local-6989586621679145735"><a href="#local-6989586621679145735"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><a name="local-6989586621679145736"><a href="#local-6989586621679145736"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679145735"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679145736"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>  </span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><a name="local-6989586621679145737"><a href="#local-6989586621679145737"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145738"><a href="#local-6989586621679145738"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HW03.html#interpL1"><span class="hs-identifier hs-var">interpL1</span></a><span> </span><a href="#local-6989586621679145737"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="HW03.html#interpL1"><span class="hs-identifier hs-var">interpL1</span></a><span> </span><a href="#local-6989586621679145738"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><a name="local-6989586621679145739"><a href="#local-6989586621679145739"><span class="hs-identifier">i1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><a name="local-6989586621679145740"><a href="#local-6989586621679145740"><span class="hs-identifier">i2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#ValueA"><span class="hs-identifier hs-var">L1.ValueA</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntV"><span class="hs-identifier hs-var">L1.IntV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679145739"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679145740"><span class="hs-identifier hs-var">i2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-identifier">testInterpL1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-67"></a><a name="testInterpL1"><a href="HW03.html#testInterpL1"><span class="hs-identifier">testInterpL1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X1&quot;</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpL1&quot;</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#interpL1"><span class="hs-identifier hs-var">interpL1</span></a><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/x1&quot;</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L1.Util.html#pExpr"><span class="hs-identifier hs-var">L1.pExpr</span></a><span> </span><a href="Lang.L1.Util.html#pAnswer"><span class="hs-identifier hs-var">L1.pAnswer</span></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">----------</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- [X2] -- </span><span>
</span><a name="line-77"></a><span class="hs-comment">----------</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- Here is a desugaring pass for minus into L1:</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">desugarMinus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L1M.Data.html#Expr"><span class="hs-identifier hs-type">L1M.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#Expr"><span class="hs-identifier hs-type">L1.Expr</span></a><span>
</span><a name="line-82"></a><a name="desugarMinus"><a href="HW03.html#desugarMinus"><span class="hs-identifier">desugarMinus</span></a></a><span> </span><a name="local-6989586621679145741"><a href="#local-6989586621679145741"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679145741"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-83"></a><span>  </span><a href="Lang.L1M.Data.html#IntE"><span class="hs-identifier hs-var">L1M.IntE</span></a><span> </span><a name="local-6989586621679145742"><a href="#local-6989586621679145742"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><a href="#local-6989586621679145742"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-84"></a><span>  </span><a href="Lang.L1M.Data.html#PlusE"><span class="hs-identifier hs-var">L1M.PlusE</span></a><span> </span><a name="local-6989586621679145743"><a href="#local-6989586621679145743"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145744"><a href="#local-6989586621679145744"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#PlusE"><span class="hs-identifier hs-var">L1.PlusE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145743"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145744"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>  </span><a href="Lang.L1M.Data.html#TimesE"><span class="hs-identifier hs-var">L1M.TimesE</span></a><span> </span><a name="local-6989586621679145745"><a href="#local-6989586621679145745"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145746"><a href="#local-6989586621679145746"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145745"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145746"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>  </span><a href="Lang.L1M.Data.html#MinusE"><span class="hs-identifier hs-var">L1M.MinusE</span></a><span> </span><a name="local-6989586621679145747"><a href="#local-6989586621679145747"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145748"><a href="#local-6989586621679145748"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#PlusE"><span class="hs-identifier hs-var">L1.PlusE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145747"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span> </span><a href="#local-6989586621679145748"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">testDesugarMinus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-89"></a><a name="testDesugarMinus"><a href="HW03.html#testDesugarMinus"><span class="hs-identifier">testDesugarMinus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X2&quot;</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;desugarMinus&quot;</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#desugarMinus"><span class="hs-identifier hs-var">desugarMinus</span></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/x2&quot;</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L1M.Util.html#pExpr"><span class="hs-identifier hs-var">L1M.pExpr</span></a><span> </span><a href="Lang.L1.Util.html#pExpr"><span class="hs-identifier hs-var">L1.pExpr</span></a><span>
</span><a name="line-95"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">----------</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- [X3] --</span><span>
</span><a name="line-99"></a><span class="hs-comment">----------</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- Here is a desugaring pass for minus and negation into L1:</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-identifier">desugarMinusNeg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L1MN.Data.html#Expr"><span class="hs-identifier hs-type">L1MN.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#Expr"><span class="hs-identifier hs-type">L1.Expr</span></a><span>
</span><a name="line-104"></a><a name="desugarMinusNeg"><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier">desugarMinusNeg</span></a></a><span> </span><a name="local-6989586621679145749"><a href="#local-6989586621679145749"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679145749"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-105"></a><span>  </span><a href="Lang.L1MN.Data.html#IntE"><span class="hs-identifier hs-var">L1MN.IntE</span></a><span> </span><a name="local-6989586621679145750"><a href="#local-6989586621679145750"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><a href="#local-6989586621679145750"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-106"></a><span>  </span><a href="Lang.L1MN.Data.html#PlusE"><span class="hs-identifier hs-var">L1MN.PlusE</span></a><span> </span><a name="local-6989586621679145751"><a href="#local-6989586621679145751"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145752"><a href="#local-6989586621679145752"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#PlusE"><span class="hs-identifier hs-var">L1.PlusE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145751"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145752"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>  </span><a href="Lang.L1MN.Data.html#TimesE"><span class="hs-identifier hs-var">L1MN.TimesE</span></a><span> </span><a name="local-6989586621679145753"><a href="#local-6989586621679145753"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145754"><a href="#local-6989586621679145754"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145753"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145754"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>  </span><a href="Lang.L1MN.Data.html#MinusE"><span class="hs-identifier hs-var">L1MN.MinusE</span></a><span> </span><a name="local-6989586621679145755"><a href="#local-6989586621679145755"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679145756"><a href="#local-6989586621679145756"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#PlusE"><span class="hs-identifier hs-var">L1.PlusE</span></a><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145755"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145756"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>  </span><a href="Lang.L1MN.Data.html#NegE"><span class="hs-identifier hs-var">L1MN.NegE</span></a><span> </span><a name="local-6989586621679145757"><a href="#local-6989586621679145757"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L1.Data.html#TimesE"><span class="hs-identifier hs-var">L1.TimesE</span></a><span> </span><span class="hs-special">(</span><a href="Lang.L1.Data.html#IntE"><span class="hs-identifier hs-var">L1.IntE</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span> </span><a href="#local-6989586621679145757"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-comment">-- -- also works</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-comment">-- L1MN.NegE e' -&gt; desugarMinusNeg (L1MN.MinusE (L1MN.IntE 0) e')</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-comment">-- -- doesnt work (because L1.MinusE isn't valid)</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-comment">-- L1MN.NegE e' -&gt; L1.MinusE (L1.IntE 0) (desugarMinusNeg e')</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">testDesugarMinusNeg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-116"></a><a name="testDesugarMinusNeg"><a href="HW03.html#testDesugarMinusNeg"><span class="hs-identifier">testDesugarMinusNeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;X3&quot;</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;desugarMinusNeg&quot;</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#desugarMinusNeg"><span class="hs-identifier hs-var">desugarMinusNeg</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/x3&quot;</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L1MN.Util.html#pExpr"><span class="hs-identifier hs-var">L1MN.pExpr</span></a><span> </span><a href="Lang.L1.Util.html#pExpr"><span class="hs-identifier hs-var">L1.pExpr</span></a><span>
</span><a name="line-122"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- ASSIGNMENT --</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- ========== --</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- [E1]: &#9733;&#9733;&#9733; --</span><span>
</span><a name="line-130"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- Write an interpreter for the L2 langauge which includes booleans, boolean</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- operations, and equality. The equality comparison operation should work on</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- both integer and boolean values.</span><span>
</span><a name="line-135"></a><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- - the operators for &quot;equality&quot;, &quot;logical or&quot;, and &quot;logical and&quot; in Haskell are</span><span>
</span><a name="line-138"></a><span class="hs-comment">--   `==`, `||` and `&amp;&amp;` respectively. The function for logical negation in</span><span>
</span><a name="line-139"></a><span class="hs-comment">--   Haskell is `not`.</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-identifier">interpL2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L2.Data.html#Expr"><span class="hs-identifier hs-type">L2.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L2.Data.html#Answer"><span class="hs-identifier hs-type">L2.Answer</span></a><span>
</span><a name="line-142"></a><a name="interpL2"><a href="HW03.html#interpL2"><span class="hs-identifier">interpL2</span></a></a><span> </span><a name="local-6989586621679145758"><a href="#local-6989586621679145758"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-identifier">testInterpL2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-145"></a><a name="testInterpL2"><a href="HW03.html#testInterpL2"><span class="hs-identifier">testInterpL2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E1&quot;</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;interpL2&quot;</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#interpL2"><span class="hs-identifier hs-var">interpL2</span></a><span>
</span><a name="line-149"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/e1&quot;</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L2.Util.html#pExpr"><span class="hs-identifier hs-var">L2.pExpr</span></a><span> </span><a href="Lang.L2.Util.html#pAnswer"><span class="hs-identifier hs-var">L2.pAnswer</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- [E2]: &#9733;&#9733;&#9734; --</span><span>
</span><a name="line-155"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- Write a desugaring pass from L2 to L2C which doesn't have &quot;logical and&quot;. You</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- should desugar `e1 &amp;&amp; e2` to `!(!e1 || !e2)`.</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-identifier">desugarL2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lang.L2.Data.html#Expr"><span class="hs-identifier hs-type">L2.Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lang.L2C.Data.html#Expr"><span class="hs-identifier hs-type">L2C.Expr</span></a><span>
</span><a name="line-161"></a><a name="desugarL2"><a href="HW03.html#desugarL2"><span class="hs-identifier">desugarL2</span></a></a><span> </span><a name="local-6989586621679145773"><a href="#local-6989586621679145773"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-identifier">testDesugarL2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-164"></a><a name="testDesugarL2"><a href="HW03.html#testDesugarL2"><span class="hs-identifier">testDesugarL2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-165"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E2&quot;</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;desugarL2&quot;</span><span>
</span><a name="line-167"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#desugarL2"><span class="hs-identifier hs-var">desugarL2</span></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/e2&quot;</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><a href="Lang.L2.Util.html#pExpr"><span class="hs-identifier hs-var">L2.pExpr</span></a><span> </span><a href="Lang.L2C.Util.html#pExpr"><span class="hs-identifier hs-var">L2C.pExpr</span></a><span>
</span><a name="line-170"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- [E3]: &#9733;&#9734;&#9734; --</span><span>
</span><a name="line-174"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- Return true if the two sets share a common element, and false otherwise.</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- Compute this by checking if the size of their intersection is strictly</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- greater than 0.</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- HINTS:</span><span>
</span><a name="line-181"></a><span class="hs-comment">--     </span><span>
</span><a name="line-182"></a><span class="hs-comment">--     Set.member :: Ord a =&gt; a -&gt; Set a -&gt; Bool</span><span>
</span><a name="line-183"></a><span class="hs-comment">--     Set.empty :: Set a</span><span>
</span><a name="line-184"></a><span class="hs-comment">--     Set.union :: Ord a =&gt; Set a -&gt; Set a -&gt; Set a</span><span>
</span><a name="line-185"></a><span class="hs-comment">--     Set.intersection :: Ord a =&gt; Set a -&gt; Set a -&gt; Set a</span><span>
</span><a name="line-186"></a><span class="hs-comment">--     Set.difference :: Ord a =&gt; Set a -&gt; Set a -&gt; Set a</span><span>
</span><a name="line-187"></a><span class="hs-comment">--     Set.size :: Set a -&gt; Int</span><span>
</span><a name="line-188"></a><span class="hs-comment">--     Set.insert :: Ord a =&gt; a -&gt; Set a -&gt; Set a</span><span>
</span><a name="line-189"></a><span class="hs-comment">--     Set.delete :: Ord a =&gt; a -&gt; Set a -&gt; Set a</span><span>
</span><a name="line-190"></a><span class="hs-comment">--     Set.fromList :: Ord a =&gt; [a] -&gt; Set a</span><span>
</span><a name="line-191"></a><span class="hs-comment">--     Set.toList :: Set a -&gt; [a]</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- (also see official documentation: http://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Set.html)</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-identifier">overlapping</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-196"></a><a name="overlapping"><a href="HW03.html#overlapping"><span class="hs-identifier">overlapping</span></a></a><span> </span><a name="local-6989586621679145774"><a href="#local-6989586621679145774"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679145775"><a href="#local-6989586621679145775"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TODO&quot;</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-identifier">testOverlapping</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a><span>
</span><a name="line-199"></a><a name="testOverlapping"><a href="HW03.html#testOverlapping"><span class="hs-identifier">testOverlapping</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#TestDir"><span class="hs-identifier hs-var">TestDir</span></a><span>
</span><a name="line-200"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;E3&quot;</span><span>
</span><a name="line-201"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;overlapping&quot;</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="HW03.html#overlapping"><span class="hs-identifier hs-var">overlapping</span></a><span>
</span><a name="line-203"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tests/hw03/e3&quot;</span><span>
</span><a name="line-204"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Lex.html#parseTest"><span class="hs-identifier hs-var">parseTest</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pPair"><span class="hs-identifier hs-var">pPair</span></a><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pSet"><span class="hs-identifier hs-var">pSet</span></a><span> </span><a href="Util.Lex.html#pInt"><span class="hs-identifier hs-var">pInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Util.Lex.html#pSet"><span class="hs-identifier hs-var">pSet</span></a><span> </span><a href="Util.Lex.html#pInt"><span class="hs-identifier hs-var">pInt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="Util.Lex.html#pBool"><span class="hs-identifier hs-var">pBool</span></a><span>
</span><a name="line-205"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><a name="main"><a href="HW03.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.Testing.html#runTests"><span class="hs-identifier hs-var">runTests</span></a><span>
</span><a name="line-209"></a><span>  </span><span class="hs-comment">-- examples</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="HW03.html#testInterpL1"><span class="hs-identifier hs-var">testInterpL1</span></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#testDesugarMinus"><span class="hs-identifier hs-var">testDesugarMinus</span></a><span>
</span><a name="line-212"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#testDesugarMinusNeg"><span class="hs-identifier hs-var">testDesugarMinusNeg</span></a><span>
</span><a name="line-213"></a><span>  </span><span class="hs-comment">-- assignment</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#testInterpL2"><span class="hs-identifier hs-var">testInterpL2</span></a><span>
</span><a name="line-215"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#testDesugarL2"><span class="hs-identifier hs-var">testDesugarL2</span></a><span>
</span><a name="line-216"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HW03.html#testOverlapping"><span class="hs-identifier hs-var">testOverlapping</span></a><span>
</span><a name="line-217"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-218"></a></pre></body></html>